<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8" data-next-head=""/><meta content="width=device-width, initial-scale=1" name="viewport" data-next-head=""/><script async="" src="https://www.googletagmanager.com/gtag/js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0="></script><title data-next-head="">ZMKのオートマウスレイヤーを極める</title><link rel="canonical" href="https://zenn.dev/kot149/articles/zmk-auto-mouse-layer" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta property="og:url" content="https://zenn.dev/kot149/articles/zmk-auto-mouse-layer" data-next-head=""/><meta property="og:title" content="ZMKのオートマウスレイヤーを極める" data-next-head=""/><meta property="og:image" content="https://res.cloudinary.com/zenn/image/upload/s--wsvO4p9M--/c_fit%2Cg_north_west%2Cl_text:notosansjp-medium.otf_55:ZMK%25E3%2581%25AE%25E3%2582%25AA%25E3%2583%25BC%25E3%2583%2588%25E3%2583%259E%25E3%2582%25A6%25E3%2582%25B9%25E3%2583%25AC%25E3%2582%25A4%25E3%2583%25A4%25E3%2583%25BC%25E3%2582%2592%25E6%25A5%25B5%25E3%2582%2581%25E3%2582%258B%2Cw_1010%2Cx_90%2Cy_100/g_south_west%2Cl_text:notosansjp-medium.otf_37:kot149%2Cx_203%2Cy_121/g_south_west%2Ch_90%2Cl_fetch:aHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3plbm4tdXNlci11cGxvYWQvYXZhdGFyL2JlMjhmNWUwZjkuanBlZw==%2Cr_max%2Cw_90%2Cx_87%2Cy_95/v1627283836/default/og-base-w1200-v2.png?_a=BACAGSGT" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="og:site_name" content="Zenn" data-next-head=""/><meta content="https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg" name="zenn:image" data-next-head=""/><meta content="kot149さんによる記事" name="zenn:description" data-next-head=""/><meta content="Zenn" name="apple-mobile-web-app-title"/><link href="/manifest.json" rel="manifest"/><link href="https://static.zenn.studio/images/logo-transparent.png" rel="shortcut icon" type="image/png"/><link href="https://static.zenn.studio/images/icon.png" rel="apple-touch-icon-precomposed" type="image/png"/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="preload" href="https://static.zenn.studio/_next/static/css/67dc5ced1621f6fc.css" as="style"/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="preload" href="https://static.zenn.studio/_next/static/css/97f15a0f8ffd0b81.css" as="style"/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="preload" href="https://static.zenn.studio/_next/static/css/1f7d57f9f2ad889e.css" as="style"/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="preload" href="https://static.zenn.studio/_next/static/css/cecd1a8ad60e0a13.css" as="style"/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="preload" href="https://static.zenn.studio/_next/static/css/b3b7b188fc2054c2.css" as="style"/><script nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">function getSystemTheme() {
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark-blue';
          }
          return 'light';
        }
        
        function applyTheme(theme) {
          let actualTheme;
          if (theme === 'system') {
            actualTheme = getSystemTheme();
          } else {
            actualTheme = theme;
          }
          window.document.documentElement.dataset.theme = actualTheme;
        }
        
        const storedTheme = localStorage.getItem('theme');
        const theme = storedTheme || 'system';
        applyTheme(theme);
        
        // システムテーマの変更を監視
        if (window.matchMedia) {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function() {
            const currentTheme = localStorage.getItem('theme') || 'system';
            if (currentTheme === 'system') {
              applyTheme('system');
            }
          });
        }</script><script nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">var newDataLayer = {};

        // display_modeを追加
        if (window.matchMedia('(display-mode: standalone)').matches) {
          newDataLayer.display_mode = 'standalone'; // PWA
        } else if (window.navigator.standalone === true) {
          newDataLayer.display_mode = 'standalone'; // PWA on iOS Safari
        } else {
          newDataLayer.display_mode = 'browser'; // Web
        }

        // user_idを追加
        // ページ初期化時に取得したいため、ローカルストレージからcachedUser.idを取得する
        var zennCurrentUserValue = localStorage.getItem('zenn_current_user');
        if (zennCurrentUserValue) {
          try {
            var currentUser = JSON.parse(zennCurrentUserValue);
            if (currentUser.cachedUser) {
              newDataLayer.user_id = currentUser.cachedUser.id;
            }
          } catch {}
        }

        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push(newDataLayer);</script><script nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-K42DRM8');</script><script nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());</script><script src="https://embed.zenn.studio/js/listen-embed-event.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0="></script><style nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">
            @font-face {
              font-family: 'Inter';
              font-weight: 600;
              font-display: swap;
              src: local(''), url('https://static.zenn.studio/fonts/inter-v3-latin-600.woff2') format('woff2');
            }
            @font-face {
              font-family: 'Inter';
              font-weight: 700;
              font-display: swap;
              src: local(''), url('https://static.zenn.studio/fonts/inter-v3-latin-700.woff2') format('woff2');
            }</style><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="stylesheet" href="https://static.zenn.studio/_next/static/css/67dc5ced1621f6fc.css" data-n-g=""/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="stylesheet" href="https://static.zenn.studio/_next/static/css/97f15a0f8ffd0b81.css" data-n-p=""/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="stylesheet" href="https://static.zenn.studio/_next/static/css/1f7d57f9f2ad889e.css" data-n-p=""/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="stylesheet" href="https://static.zenn.studio/_next/static/css/cecd1a8ad60e0a13.css"/><link nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" rel="stylesheet" href="https://static.zenn.studio/_next/static/css/b3b7b188fc2054c2.css"/><noscript data-n-css="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0="></noscript><script defer="" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" noModule="" src="https://static.zenn.studio/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script defer="" src="https://static.zenn.studio/_next/static/chunks/782.9bf9e0e1ba09fa45.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0="></script><script src="https://static.zenn.studio/_next/static/chunks/webpack-58b77a8b5e67f5c3.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/framework-f8fc9d22713dd1d8.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/main-31fb9a937b29b7f7.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/pages/_app-0dbe4f012f36ac93.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/1284-a46d7d77b1cc1f98.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/4016-c80ac5a6d15017ba.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/6189-3db74505d2770948.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/4163-0f3efd5f5f189f6a.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/7482-eb94f2a3adfd1062.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/4654-419314cc7204967f.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/2421-5bfacfe3e5e7ddc4.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/9518-1b19654070452685.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/1438-5ae8f575436a1c65.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/5402-18cfc1ff81060076.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/chunks/pages/%5Busername%5D/articles/%5Bslug%5D-81580f68479f39fd.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/TlGRyyN3vX07v1SqAl6k1/_buildManifest.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script><script src="https://static.zenn.studio/_next/static/TlGRyyN3vX07v1SqAl6k1/_ssgManifest.js" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=" defer=""></script></head><body><script nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">const shouldUseTwemoji = !/(googlebot|macintosh|macintel|macppc|mac68k|macos|iphone|ipad)/i.test(window.navigator.userAgent);
        if(shouldUseTwemoji) document.body.setAttribute("data-use-twemoji", "true");</script><link rel="preload" as="image" href="https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg" referrerPolicy="no-referrer"/><div id="__next"><header class="AppHeader_header__54XdE"><div class="Container_wide__ykGLh Container_common__figYY"><div class="AppHeader_inner__CJC4C"><a class="ZennLogo_logoLink__NJS2l" href="/"><svg viewBox="0 0 377.4 88.3" aria-label="Zenn | エンジニアのための情報共有コミュニティ" class="ZennLogo_logoSvg__yOhcg" height="22"><g fill="currentColor"><path d="M233 56.8h-39c.5 3.5 2.2 6.8 4.8 9.2 2.7 2.3 6.2 3.5 9.8 3.4 2.8 0 5.6-.5 8.2-1.7 2.5-1.1 4.8-2.8 6.5-5l8.2 9.5c-2.5 3.4-5.7 6.1-9.5 7.9-4.6 2.2-9.6 3.3-14.7 3.2-5.7.1-11.4-1.2-16.5-4-4.5-2.5-8.2-6.3-10.7-10.9s-3.8-9.8-3.7-15.1v-2.2c-.1-5.7 1.1-11.3 3.5-16.5 2.2-4.7 5.7-8.6 10.1-11.3 4.7-2.8 10.1-4.2 15.5-4.1 5.2-.1 10.3 1.1 14.9 3.7 4.1 2.5 7.4 6.2 9.4 10.5 2.2 5.1 3.3 10.5 3.2 16.1V56.8zM216.1 43.9c.1-2.9-.9-5.7-2.8-7.9-1.8-1.9-4.4-2.9-7.9-2.9-2.9-.1-5.8 1.1-7.7 3.2-2 2.6-3.3 5.7-3.6 9h22V43.9zM128.3 67.9h36.1v14.7h-56.9V72l35.8-54.3h-36.2V2.9h56.6v10.4L128.3 67.9zM248.8 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1s-12.4 5.5-12.4 16.1v30.7h-15.8L248.8 50.7 248.8 50.7zM320.3 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1S336 40.8 336 51.4v30.7h-15.8L320.3 50.7 320.3 50.7z"></path></g><path fill="#3EA8FF" d="M2.4 83.3h17c.9 0 1.7-.5 2.2-1.2L68.4 5.2C69 4.2 68.3 3 67.1 3H51c-.8 0-1.5.4-1.9 1.1L1.6 81.9C1.3 82.5 1.7 83.3 2.4 83.3zM61 82.1l22.1-35.5c.7-1.1-.1-2.5-1.4-2.5H65.7c-.6 0-1.2.3-1.5.8L41.5 81.2c-.6.9.1 2.1 1.2 2.1h16.3C59.8 83.3 60.6 82.9 61 82.1z" class="st0"></path></svg></a></div></div></header><article class="View_container__VQuzA"><aside class="ContentStickyNavForMobile_container__153a8"><div class="Container_wide__ykGLh Container_common__figYY"><div class="ContentStickyNavForMobile_inner__xJ_fS"><div class="ContentStickyNavForMobile_avatarInner__3_noS"><a class="ContentStickyNavForMobile_principalLink__c15vw" href="/kot149"><span class="ContentStickyNavForMobile_avatarContainer__V3P_G"><img alt="kot149" class="AvatarImage_border__pDIjF AvatarImage_plain__Fgp4R " height="38" referrerPolicy="no-referrer" src="https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg" width="38"/></span><span class="ContentStickyNavForMobile_displayName__cmEag">kot149</span></a></div><div class="ContentStickyNavForMobile_actions__a9fMk"></div></div></div></aside><header class="ArticleHeader_header__IRbtk"><div class="Container_wide__ykGLh Container_common__figYY"><div class="ArticleHeader_main__W98WY"><div class="ArticleHeader_emoji__30JiU"><span class="Emoji_twemoji__hcxYF"><span class="Emoji_twemojiImg__Oc6vR" style="background-image:url(https://asia-northeast1-zenn-dev-production.cloudfunctions.net/twemoji/%E2%8C%A8%EF%B8%8F.svg)"></span></span><span class="Emoji_nativeEmoji__GMBzX">⌨️</span></div><h1 class="ArticleHeader_title__9jiOv"><span style="font-size:0.9279999999999999em">ZMKのオートマウスレイヤーを極める</span></h1><div class="ArticleHeader_metaContainer__5UzrJ"><div class="ArticleHeader_metaInfo__XrRdh"><span class="ArticleHeader_pubDate__gF_sc"><time class="ArticleHeader_num__7Zpz0" dateTime="2025-06-15T08:17:09+00:00">2025/06/15</time>に公開</span><div class="ArticleHeader_updateDateContainer__3bpiJ"><div aria-label="更新日" class="ArticleHeader_updateDate__W9Sai" data-tooltip-for-desktop="true" data-tooltip-position="bottom" role="tooltip"><svg xml:space="preserve" viewBox="0 0 24 24" height="14" width="14"><g fill="currentColor"><path d="M2.9 10H8c.2 0 .4-.1.6-.3.3-.3.3-.7 0-1.1l-2.2-2c1.5-1.5 3.5-2.3 5.6-2.3 4 0 7.2 2.9 7.7 6.8.1.7.7 1.1 1.4 1.1l.1 0c.8-.1 1.2-.8 1.1-1.5-.5-5.2-5-9.1-10.3-9.1-2.8 0-5.5 1.1-7.4 3.1L2.8 2.9c-.3-.3-.7-.3-1.1 0C1.5 3.1 1.5 3.3 1.5 3.5v5.1C1.5 9.3 2.1 10 2.9 10zM21.1 14H16c-.2 0-.4.1-.6.3-.3.3-.3.7 0 1.1l2.1 2.1c-1.5 1.5-3.5 2.3-5.6 2.3-4 0-7.2-2.9-7.7-6.9-.2-.7-.9-1.3-1.6-1.2-.8.1-1.2.8-1.1 1.5.5 5.2 5 9.1 10.3 9.1 2.8 0 5.5-1.1 7.4-3.1l1.8 1.8c.3.3.7.3 1.1 0 .1-.1.3-.3.3-.6v-5.1C22.5 14.7 21.9 14 21.1 14z"></path></g></svg><span class="ArticleHeader_num__7Zpz0">2025/09/28</span></div></div><a class="ArticleHeader_commentsLink__QKD9j" href="#discuss"><svg viewBox="0 0 27 27" height="16" width="16"><path fill="currentColor" d="M5.9,25.3a1.27,1.27,0,0,1-.6-.1,1.68,1.68,0,0,1-.9-1.3V18.8a8.53,8.53,0,0,1-2.2-6.4C2.2,6.5,6.9,2.3,13.5,2.3S24.8,6.6,24.8,12.4,20,22.6,13.5,22.6a6.36,6.36,0,0,1-2.5-.3L6.7,25A1.6,1.6,0,0,1,5.9,25.3ZM13.5,4.7c-5.2,0-8.8,3.2-8.8,7.7,0,2.4.5,3.7,1.8,5a1.09,1.09,0,0,1,.4.9V22l3.3-2.1a1.38,1.38,0,0,1,1.1-.1,4.49,4.49,0,0,0,2.3.4c5.2,0,8.8-3.2,8.8-7.7S18.7,4.7,13.5,4.7Z"></path></svg><span class="ArticleHeader_num__7Zpz0">1<!-- -->件</span></a></div></div></div></div></header><div class="Container_wide__ykGLh Container_common__figYY"><div class="ContainerUndo_undoInSM__1vdc1"><div class="View_inner__LlCJG"><div class="View_stickyShare__TsaVf"><div class="View_stickyShareInner__FLu2S"><div class="LikeButton_container__YlckE style-large-white count-bottom"><button aria-label="いいね" class="LikeButton_button__ZwdG4" data-pressed="false"><svg class="LikeButton_svgLike__Gl0Sz" viewBox="0 0 110 110"><path class="LikeButton_svgLikeLine__f9txR" d="M73,24a23.78,23.78,0,0,0-15.89,6.19,3.14,3.14,0,0,1-4.18,0A23.81,23.81,0,0,0,37,24a22,22,0,0,0-22,22c0,16.67,19.64,32.82,25.11,37.93,2.84,2.65,6.15,5.64,8.92,8.13a8.9,8.9,0,0,0,11.9,0c2.77-2.49,6.07-5.48,8.91-8.13C75.37,78.81,95,62.66,95,46A22,22,0,0,0,73,24Z" fill="currentColor"></path><path class="LikeButton_svgLikeInner__uiexS" d="M66.25,76.42c-.71.64-1.32,1.2-1.82,1.67-2.51,2.33-5.39,5-7.94,7.25a2.21,2.21,0,0,1-3,0C51,83,48.1,80.42,45.59,78.09c-.5-.47-1.12-1-1.82-1.67C38.09,71.29,23,57.67,23,46A14,14,0,0,1,37,32a15.92,15.92,0,0,1,11.65,5.23l4.73,5a2.2,2.2,0,0,0,3.23,0l4.72-5A16.06,16.06,0,0,1,73,32,14,14,0,0,1,87,46C87,57.67,71.93,71.29,66.25,76.42Z" fill="currentColor"></path><g class="LikeButton_svgLikeDecoration__78UjB"><circle cx="41.5" cy="9.5" fill="#3ea8ff" r="3.5"></circle><circle cx="98.5" cy="26.5" fill="#ffdc6e" r="3.5"></circle><circle cx="13" cy="19" fill="#c067f4" r="5"></circle><circle cx="77" cy="9" fill="#f76685" r="5"></circle><circle cx="26.5" cy="92.5" fill="#f76685" r="3.5"></circle><circle cx="105.5" cy="48.5" fill="#c067f4" r="3.5"></circle><circle cx="4.5" cy="60.5" fill="#3ea8ff" r="3.5"></circle><circle cx="94.5" cy="73.5" fill="#3ea8ff" r="1.5"></circle><circle cx="16.5" cy="75.5" fill="#ffdc6e" r="1.5"></circle><circle cx="78.5" cy="91.5" fill="#ffdc6e" r="1.5"></circle></g></svg></button></div><span style="display:block;height:1rem;flex-shrink:0"></span><span style="display:block;height:1rem;flex-shrink:0"></span><div class="ShareButtonsExperimental_container__CrtBj" style="flex-direction:column;align-items:stretch"><a aria-label="X(Twitter)にポスト" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgTwitterVertical__NmmfB ShareButtonsExperimental_svgTwitterBase__8FrNq" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://twitter.com/intent/tweet?url=https://zenn.dev/kot149/articles/zmk-auto-mouse-layer&amp;text=ZMK%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%A5%B5%E3%82%81%E3%82%8B%EF%BD%9Ckot149&amp;hashtags=zenn" id="gtm-article-left-tweet" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clipPath></defs></svg></a><a aria-label="Facebookに投稿" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgFacebookVertical__3ykb7 ShareButtonsExperimental_svgFacebookBase___gDOW" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="http://www.facebook.com/sharer.php?u=https://zenn.dev/kot149/articles/zmk-auto-mouse-layer" id="gtm-article-left-facebook" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="28" height="29" fill="none" viewBox="0 0 28 29"><g clip-path="url(#a)"><path fill="currentColor" d="M28 14.7812C28 7.02084 21.7319 0.729736 14 0.729736C6.26808 0.729736 0 7.02084 0 14.7812C0 21.3707 4.52032 26.9002 10.6182 28.4189V19.0753H7.73136V14.7812H10.6182V12.9309C10.6182 8.14833 12.7747 5.93158 17.453 5.93158C18.34 5.93158 19.8705 6.10637 20.4966 6.28061V10.1729C20.1662 10.138 19.5922 10.1206 18.8793 10.1206C16.5838 10.1206 15.6968 10.9935 15.6968 13.2625V14.7812H20.2698L19.4841 19.0753H15.6968V28.7297C22.629 27.8895 28.0006 21.9654 28.0006 14.7812H28Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0H28V28H0z" transform="translate(0 .73)"></path></clipPath></defs></svg></a><a aria-label="はてなブックマークに登録" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgHatenaBookmarkVertical__b161J ShareButtonsExperimental_svgHatenaBookmarkBase__VXz6p" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://b.hatena.ne.jp/add?mode=confirm&amp;url=https://zenn.dev/kot149/articles/zmk-auto-mouse-layer&amp;title=ZMK%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%A5%B5%E3%82%81%E3%82%8B%EF%BD%9Ckot149" id="gtm-article-left-hatena-bookmark" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><path fill="currentColor" fill-rule="evenodd" d="M5.4999 0.729736H21.5001C24.5376 0.729736 27 3.19213 27 6.22964V22.2298C27 25.2673 24.5376 27.7297 21.5001 27.7297H5.4999C2.46239 27.7297 0 25.2673 0 22.2298V6.22964C0 3.19213 2.46239 0.729736 5.4999 0.729736ZM12.98 13.7472C13.8521 13.8136 14.5319 14.1209 15.0212 14.6673V14.6679C15.512 15.2127 15.7572 15.9444 15.7572 16.8543C15.7572 17.5126 15.62 18.0877 15.3436 18.5867C15.0692 19.084 14.6756 19.4712 14.1604 19.7433C13.7441 19.9658 13.2289 20.1278 12.6155 20.2245C12.001 20.3179 10.9966 20.3665 9.6039 20.3665H6.13656V8.09392H9.50184C10.8859 8.09392 11.8503 8.13875 12.4016 8.22623C12.9503 8.31695 13.4206 8.4703 13.8164 8.68792C14.269 8.93902 14.6129 9.27437 14.8527 9.69341C15.0865 10.1151 15.2069 10.6028 15.2069 11.1546C15.2069 11.8512 15.0309 12.4053 14.6761 12.813C14.3197 13.2261 13.756 13.5355 12.98 13.7472ZM9.96192 10.8144H9.24372H9.24318V13.2768H9.91116C10.7352 13.2768 11.2984 13.1856 11.6073 13.0058C11.9124 12.8227 12.0663 12.5273 12.0663 12.0667C12.0663 11.6061 11.9216 11.2821 11.6375 11.0947C11.3497 10.9084 10.7919 10.8144 9.96192 10.8144ZM10.4128 18.1514C11.2028 18.1514 11.7661 18.0531 12.0928 17.8523V17.8528C12.4227 17.653 12.5863 17.3209 12.5863 16.8581C12.5863 16.3408 12.4367 15.9806 12.1338 15.7765C11.8357 15.5724 11.2747 15.4703 10.463 15.4703H9.24372V18.1514H10.4128ZM19.3093 17.257C18.4502 17.257 17.7547 17.9525 17.7547 18.8111C17.7547 19.6697 18.4507 20.3658 19.3093 20.3658C20.1679 20.3658 20.8634 19.6697 20.8634 18.8111C20.8634 17.9525 20.1668 17.257 19.3093 17.257ZM17.9593 8.09318H20.6593V16.2753H17.9593V8.09318Z" clip-rule="evenodd"></path></svg></a></div></div></div><div class="View_columnsContainer__ijfFN"><section class="View_content__OZ_Dc"><div class="View_main__AU6KW"><div class="Container_default__13H8g Container_common__figYY"><div class="View_topics__2sHkl"><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="/topics/keyboard"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="https://storage.googleapis.com/zenn-user-upload/topics/466b24af98.png" width="26"/></div><div class="TopicList_name__xMwaW">Keyboard</div></a><a class="TopicList_item___M3DS" style="font-size:0.8rem;padding:2px" href="/topics/zmk"><div class="TopicList_image__Sqd63"><img class="TopicList_img__qj3KE" height="26" loading="lazy" src="https://zenn.dev/images/topic.png" width="26"/></div><div class="TopicList_name__xMwaW">zmk</div></a><a class="View_topicLink__jdtX_" href="/tech-or-idea"><div class="View_topicImage__qMmmw"><img class="View_topicImg__TpkV5" loading="lazy" src="https://static.zenn.studio/images/drawing/tech-icon.svg"/></div><div class="View_topicName____nYp" style="text-transform:capitalize">tech</div></a></div><div class="znc BodyContentViewer_headingAnchorStyle__qn_OJ"><h2 id="%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%A8%E3%81%AF" data-line="0" class="code-line">
<a class="header-anchor-link" href="#%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%A8%E3%81%AF" aria-hidden="true"></a> オートマウスレイヤーとは</h2>
<p data-line="2" class="code-line">オートマウスレイヤーとは、<strong>「マウスカーソルを動かすと、自動的に一定時間マウスレイヤーが有効になる機能」</strong> のことです。<br>
自動マウスレイヤー、または略してAMLと呼ばれる場合もあります。</p>
<p data-line="5" class="code-line">AMLを利用することで、<a href="https://shirogane-lab.net/items/64b8f8693ee3fd0045280190" target="_blank" rel="nofollow noopener noreferrer">Keyballシリーズ</a>のようなトラックボール付きキーボードにおいて、デフォルトレイヤーのキー数を節約しつつ、キー入力とマウス操作をスムーズに切り替えることが可能になります。</p>
<p data-line="7" class="code-line">この記事では、Keyball/QMKのAMLにあるような</p>
<ul data-line="9" class="code-line">
<li data-line="9" class="code-line">非マウスキーを押したらマウスレイヤーを抜ける</li>
<li data-line="10" class="code-line">マウスキーを押したらタイムアウトを延長する</li>
<li data-line="11" class="code-line">マウスキーを押すまでマウスレイヤーに留まる<sup class="footnote-ref"><a href="#fn-85a1-1" id="fnref-85a1-1">[1]</a></sup>
</li>
</ul>
<p data-line="15" class="code-line">などの機能をZMKで設定する方法を解説します。</p>
<aside class="msg message"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="18" class="code-line">この記事では、トラックボール付きキーボードである<a href="https://github.com/kumamuk-git/roBa" target="_blank" rel="nofollow noopener noreferrer">roBa</a>を例として設定例を示しますが、他のZMKを採用したキーボードにも共通して使用可能です。<br>
ただし、設定の記載先のファイルや、ピン、ラベルの名前は異なる可能性があります。</p>
</div></aside>
<h2 id="zmk%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC" data-line="22" class="code-line">
<a class="header-anchor-link" href="#zmk%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC" aria-hidden="true"></a> ZMKにおけるオートマウスレイヤー</h2>
<p data-line="24" class="code-line">ZMKのオートマウスレイヤーには</p>
<ol data-line="26" class="code-line">
<li data-line="26" class="code-line">
<a href="https://github.com/inorichi/zmk-pmw3610-driver" target="_blank" rel="nofollow noopener noreferrer">zmk-pmw3610-driver</a><sup class="footnote-ref"><a href="#fn-85a1-2" id="fnref-85a1-2">[2]</a></sup> で実装されているもの</li>
<li data-line="27" class="code-line">
<a href="https://zmk.dev/docs/keymaps/input-processors" target="_blank" rel="nofollow noopener noreferrer">Input Processor</a> を使用したもの</li>
</ol>
<p data-line="29" class="code-line">の2種類が存在します。</p>
<p data-line="33" class="code-line">zmk-pmw3610-driverのAML機能は非常にシンプルで、QMKにあるような、</p>
<ul data-line="35" class="code-line">
<li data-line="35" class="code-line">非マウスキーを押したらマウスレイヤーを抜ける</li>
<li data-line="36" class="code-line">マウスキーを押したらタイムアウトを延長する</li>
</ul>
<p data-line="38" class="code-line">という機能はありません。</p>
<p data-line="40" class="code-line">Input ProcessorによるAMLは、pmw3610-driverのAMLより新しくできたもので、より汎用的かつ高機能であり、設定すれば上記の機能も使用可能になります。<br>
今から新しく設定するなら、Input Processorを使用することを推奨します。</p>
<h2 id="%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95" data-line="43" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95" aria-hidden="true"></a> 設定方法</h2>
<h3 id="pmw3610-driver%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC" data-line="46" class="code-line">
<a class="header-anchor-link" href="#pmw3610-driver%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC" aria-hidden="true"></a> PMW3610 Driverのオートマウスレイヤー</h3>
<p data-line="48" class="code-line"><code>&amp;trackball</code>に<code>automouse-layer</code>を設定します。<br>
この例では、トラボを動かすとレイヤー5が有効になります。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="diff-highlight language-diff-dts"><code class="diff-highlight language-diff-dts code-line" data-line="51">&amp;spi0 {
<span class="token unchanged"><span class="token prefix unchanged"> </span>   status = "okay";
<span class="token prefix unchanged"> </span>   compatible = ...
</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span>   trackball: trackball@0 {
<span class="token prefix unchanged"> </span>       status = "okay";
<span class="token prefix unchanged"> </span>       compatible = "pixart,pmw3610";
<span class="token prefix unchanged"> </span>       ...
</span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span>       automouse-layer = &lt;5&gt;;
</span><span class="token unchanged"><span class="token prefix unchanged"> </span>   };
</span>};
</code></pre>
</div><p data-line="66" class="code-line">タイムアウトの長さを変えるには、<code>CONFIG_PMW3610_AUTOMOUSE_TIMEOUT_MS</code>を設定します。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.conf</span></div>
<pre class="language-kconfig"><code class="language-kconfig code-line" data-line="68">CONFIG_PMW3610_AUTOMOUSE_TIMEOUT_MS=700
</code></pre>
</div><h3 id="input-processor%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC" data-line="72" class="code-line">
<a class="header-anchor-link" href="#input-processor%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC" aria-hidden="true"></a> Input Processorを使用したオートマウスレイヤー</h3>
<p data-line="74" class="code-line"><code>&amp;trackball_listener</code>に<a href="https://zmk.dev/docs/keymaps/input-processors/temp-layer#user-defined-instances" target="_blank" rel="nofollow noopener noreferrer"><code>zip_temp_layer</code></a>というInput Processorを適用します。</p>
<aside class="msg message"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="78" class="code-line">トラックボール以外の場合は、<code>trackball_listener</code>とは違う名前がつけられている可能性があります。その場合は、<code>*_listener</code>という名前や、<code>compatible = "zmk,input-listener";</code>が指定されているものを代わりに用いてください。</p>
</div></aside>
<p data-line="81" class="code-line">この例では、トラボ使用後10秒間、レイヤー5が有効になります。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="83">#include &lt;input/processors.dtsi&gt;
/ {
    trackball_listener: trackball_listener {
        compatible = "zmk,input-listener";
        device = &lt;&amp;trackball&gt;;

        input-processors = &lt;&amp;zip_temp_layer 5 10000&gt;;
    };
};
</code></pre>
</div><aside class="msg message"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="96" class="code-line"><code>trackball_listener</code>は、<code>.overlay</code>ファイルか<code>.dtsi</code>ファイルに記載されていることが多いですが、以下のような形で<code>.keymap</code>ファイルに書かれている場合もあります。<code>.keyamp</code>に書かれている場合はそちらへ追加してください。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="98">/ {
    trackball_listener: trackball_listener {
        compatible = "zmk,input-listener";
        device = &lt;&amp;trackball&gt;;
    };
};
</code></pre>
</div>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa.keymap</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="107">#include &lt;input/processors.dtsi&gt;

&amp;trackball_listener {
    input-processors = &lt;&amp;zip_temp_layer 5 10000&gt;;
};
</code></pre>
</div>
</div></aside>
<aside class="msg alert"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="117" class="code-line">Input Processorを使用する場合は、zmk-pmw3610-driverのAMLは無効化しておきましょう。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="diff-highlight language-diff-dts"><code class="diff-highlight language-diff-dts code-line" data-line="119">&amp;spi0 {
<span class="token unchanged"><span class="token prefix unchanged"> </span>   status = "okay";
<span class="token prefix unchanged"> </span>   compatible = ...
</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span>   trackball: trackball@0 {
<span class="token prefix unchanged"> </span>       status = "okay";
<span class="token prefix unchanged"> </span>       compatible = "pixart,pmw3610";
<span class="token prefix unchanged"> </span>       ...
</span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span>       automouse-layer = &lt;5&gt;;
</span><span class="token unchanged"><span class="token prefix unchanged"> </span>   };
</span>};
</code></pre>
</div>
</div></aside>
<h3 id="%E9%9D%9E%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E9%96%A2%E4%BF%82%E3%81%AA%E3%81%8F%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%8A%9C%E3%81%91%E3%82%8B" data-line="135" class="code-line">
<a class="header-anchor-link" href="#%E9%9D%9E%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E9%96%A2%E4%BF%82%E3%81%AA%E3%81%8F%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%8A%9C%E3%81%91%E3%82%8B" aria-hidden="true"></a> 非マウスキーを押したらタイムアウトに関係なくマウスレイヤーを抜ける</h3>
<p data-line="137" class="code-line">Input Processorを使用したAMLでは、<code>excluded-positions</code>を設定すると、その位置のキー以外を押したときにAMLが解除されます。</p>
<aside class="msg message"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="140" class="code-line"><strong>注意点</strong>:</p>
<ul data-line="141" class="code-line">
<li data-line="141" class="code-line">QMKのようにマウスキーがあらかじめ定義されていないため、手動で<code>excluded-positions</code>に加える必要がある</li>
<li data-line="142" class="code-line">
<code>excluded-positions</code>を設定しなかった場合、「どのキーを押してもAMLが<strong>解除されない</strong>」。この仕様は少し分かりづらい…</li>
<li data-line="143" class="code-line">
<code>excluded-positions</code>のキーを押してもタイムアウトの延長はされないため、別途設定が必要</li>
</ul>
</div></aside>
<h4 id="%E8%A8%AD%E5%AE%9A%E4%BE%8B" data-line="146" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E4%BE%8B" aria-hidden="true"></a> 設定例</h4>
<p data-line="148" class="code-line">この例では、トラボ使用後10秒間、レイヤー5が有効になります。<br>
ただし、<code>excluded-positions</code>以外のキーを押すとAMLが解除されます。ここではroBaの<code>J</code>, <code>K</code>, <code>;</code>, <code>Ctrl</code>の位置を<code>excluded-positions</code>に設定しています。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="151">#include &lt;input/processors.dtsi&gt;

&amp;zip_temp_layer {
    excluded-positions = &lt;
        18 // J
        19 // K
        21 // ;
        34 // Ctrl
    &gt;;
};

/ {
    trackball_listener: trackball_listener {
        compatible = "zmk,input-listener";
        device = &lt;&amp;trackball&gt;;

        input-processors = &lt;&amp;zip_temp_layer 5 10000&gt;;
    };
};
</code></pre>
</div><aside class="msg message"><span class="msg-symbol">!</span><div class="msg-content">
<p data-line="174" class="code-line"><code>excluded-positions</code>の数字はキーボードのレイアウト次第で変わります。<br>
positionを知るには、<a href="https://nickcoutsos.github.io/keymap-editor/" target="_blank" rel="nofollow noopener noreferrer">Keymap Editor</a>で適当なcomboを作って、keymapファイルのcombo定義から<code>key-positions</code>を抜き出すか、<a href="https://zmk-physical-layout-converter.streamlit.app" target="_blank" rel="nofollow noopener noreferrer">ZMK physical layouts converter</a>にレイアウト定義JSONファイルを貼り付けて確認するのが簡単です。</p>
</div></aside>
<h3 id="%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B" data-line="178" class="code-line">
<a class="header-anchor-link" href="#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B" aria-hidden="true"></a> マウスキーを押したらタイムアウトを延長する</h3>
<p data-line="180" class="code-line"><code>&amp;mkp</code>(マウスキー押下)に対してInput Processorを設定することで、マウスキーを押したらタイムアウトを延長できます。</p>
<h4 id="%E8%A8%AD%E5%AE%9A%E4%BE%8B-1" data-line="182" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E4%BE%8B-1" aria-hidden="true"></a> 設定例</h4>
<p data-line="184" class="code-line"><code>.keymap</code>ファイルに以下を追記すると、クリックしたときに10秒間AMLが延長されます。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa.keymap</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="186">#include &lt;input/processors.dtsi&gt;

&amp;mkp_input_listener {
    input-processors = &lt;&amp;zip_temp_layer 5 10000&gt;;
};
</code></pre>
</div><h3 id="%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%99%E3%81%BE%E3%81%A7%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AB%E7%95%99%E3%81%BE%E3%82%8B" data-line="194" class="code-line">
<a class="header-anchor-link" href="#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%99%E3%81%BE%E3%81%A7%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AB%E7%95%99%E3%81%BE%E3%82%8B" aria-hidden="true"></a> マウスキーを押すまでマウスレイヤーに留まる</h3>
<p data-line="196" class="code-line">マウスキーを押すまでマウスレイヤーに留まる場合でも、ダブルクリックの猶予を与えるために、クリック後一定時間待つ必要があります。<br>
そのため、実は「マウスキーを押すまでマウスレイヤーに留まる」機能は「<a href="#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B">マウスキーを押したらタイムアウトを延長する</a>」と同じ実装で、タイムアウトの長さが違うだけです。</p>
<h4 id="%E8%A8%AD%E5%AE%9A%E4%BE%8B-2" data-line="199" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E4%BE%8B-2" aria-hidden="true"></a> 設定例</h4>
<p data-line="201" class="code-line"><code>.keymap</code>ファイルに以下を追記すると、クリックした後250ミリ秒後にAMLが解除されます。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa.keymap</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="203">#include &lt;input/processors.dtsi&gt;

&amp;mkp_input_listener {
    input-processors = &lt;&amp;zip_temp_layer 5 250&gt;;
};
</code></pre>
</div><p data-line="211" class="code-line">また、AML自体のタイムアウトは長めにしておきましょう。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.conf</span></div>
<pre class="language-kconfig"><code class="language-kconfig code-line" data-line="213">CONFIG_PMW3610_AUTOMOUSE_TIMEOUT_MS=100000
</code></pre>
</div><p data-line="217" class="code-line">または、Input Processorを使用している場合:</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="219">#include &lt;input/processors.dtsi&gt;
/ {
    trackball_listener: trackball_listener {
        compatible = "zmk,input-listener";
        device = &lt;&amp;trackball&gt;;

        input-processors = &lt;&amp;zip_temp_layer 5 100000&gt;;
    };
};
</code></pre>
</div><h3 id="%E3%82%AD%E3%83%BC%E5%85%A5%E5%8A%9B%E4%B8%AD%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%AA%A4%E7%88%86%E9%98%B2%E6%AD%A2" data-line="231" class="code-line">
<a class="header-anchor-link" href="#%E3%82%AD%E3%83%BC%E5%85%A5%E5%8A%9B%E4%B8%AD%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%AA%A4%E7%88%86%E9%98%B2%E6%AD%A2" aria-hidden="true"></a> キー入力中のオートマウスレイヤー誤爆防止</h3>
<p data-line="233" class="code-line">キー入力中、振動や意図せずトラボに触れてしまうことが原因でAMLが発動し、マウスクリックが誤爆することがあります。<br>
これの対策として、Input Processorを使用したAMLでは、<code>require-prior-idle-ms</code>というプロパティを設定することで、キー入力から一定時間はAMLを発動しないようにできます。</p>
<h4 id="%E8%A8%AD%E5%AE%9A%E4%BE%8B-3" data-line="236" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E4%BE%8B-3" aria-hidden="true"></a> 設定例</h4>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa_R.overlay</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="238">#include &lt;input/processors.dtsi&gt;

&amp;zip_temp_layer {
    require-prior-idle-ms = &lt;200&gt;;
};

/ {
    trackball_listener: trackball_listener {
        compatible = "zmk,input-listener";
        device = &lt;&amp;trackball&gt;;

        input-processors = &lt;&amp;zip_temp_layer 5 10000&gt;;
    };
};
</code></pre>
</div><h3 id="shift%2B%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%8B%95%E4%BD%9C%E6%94%B9%E5%96%84" data-line="255" class="code-line">
<a class="header-anchor-link" href="#shift%2B%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%8B%95%E4%BD%9C%E6%94%B9%E5%96%84" aria-hidden="true"></a> Shift+クリックの動作改善</h3>
<p data-line="257" class="code-line">ShiftキーをZキーのMod Tap(<code>&amp;mt LEFT_SHIFT Z</code>)にしているような場合、上記のInput Processorを使用したAMLでは、<br>
「マウスカーソルを動かす → Shiftを押す → クリックする」<br>
という操作によりテキストを選択しようとすると、Shiftを押した段階でAMLが解除され、クリックのつもりがキー入力になってしまいます。</p>
<p data-line="261" class="code-line">必ずShiftを押した後にマウスカーソルを動かすようにすれば対処できますが、少し面倒です。<br>
<code>excluded-positions</code>に設定する手もありますが、それだとZを入力したときにAMLが解除されず、誤爆の原因になります。</p>
<p data-line="264" class="code-line">これは、タップ時のみAML解除するbehaviorを定義することで解決できます。</p>
<h4 id="%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-1" data-line="266" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-1" aria-hidden="true"></a> 設定方法</h4>
<ol data-line="268" class="code-line">
<li data-line="268" class="code-line">レイヤーを無効化するbehavior <code>tog_off</code><sup class="footnote-ref"><a href="#fn-85a1-3" id="fnref-85a1-3">[3]</a></sup>を定義する</li>
<li data-line="269" class="code-line">AMLを解除するマクロ<code>exit_AML</code>を作る</li>
<li data-line="270" class="code-line">キー押下後にAMLを解除するマクロ<code>kp_exit_AML</code>を作る</li>
<li data-line="271" class="code-line">ホールド時は<code>kp</code>、タップ時は<code>kp_exit_AML</code>を使うhold-tap behavior <code>mt_exit_AML_on_tap</code>を定義する</li>
<li data-line="272" class="code-line">
<code>mt_exit_AML_on_tap</code>を<code>mt</code>の代わりに使う</li>
<li data-line="273" class="code-line">そのキーの位置を<code>excluded-positions</code>に入れる</li>
</ol>
<p data-line="275" class="code-line">これによりホールド時はAMLを解除せず、タップ時のみAMLを解除するという動作が可能になります。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa.keymap</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="279">#define MOUSE 5

/{
    macros {
        exit_AML: exit_AML {
            compatible = "zmk,behavior-macro";
            wait-ms = &lt;0&gt;;
            tap-ms = &lt;0&gt;;
            #binding-cells = &lt;0&gt;;
            bindings = &lt;&amp;tog_off MOUSE&gt;;
            label = "exit_AML";
        };

        kp_exit_AML: kp_exit_AML {
            compatible = "zmk,behavior-macro-one-param";
            wait-ms = &lt;0&gt;;
            tap-ms = &lt;0&gt;;
            #binding-cells = &lt;1&gt;;
            bindings = &lt;&amp;macro_param_1to1 &amp;kp MACRO_PLACEHOLDER &amp;exit_AML&gt;;
            label = "KP_exit_AML";
        };
    };

    behaviors {
        tog_off: toggle_layer_off {
            compatible = "zmk,behavior-toggle-layer";
            #binding-cells = &lt;1&gt;;
            display-name = "Toggle Layer Off";
            toggle-mode = "off";
        };

        mt_exit_AML_on_tap: mt_exit_AML_on_tap {
            compatible = "zmk,behavior-hold-tap";
            label = "MT_exit_AML_ON_TAP";
            bindings = &lt;&amp;kp&gt;, &lt;&amp;kp_exit_AML&gt;;

            #binding-cells = &lt;2&gt;;
            tapping-term-ms = &lt;200&gt;;
            flavor = "balanced";
            quick-tap-ms = &lt;200&gt;;
        };
    };
}
</code></pre>
</div><h3 id="%E3%82%AA%E3%83%9E%E3%82%B1%3A-%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%A7%E5%86%8D%E7%8F%BE%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95" data-line="325" class="code-line">
<a class="header-anchor-link" href="#%E3%82%AA%E3%83%9E%E3%82%B1%3A-%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%A7%E5%86%8D%E7%8F%BE%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95" aria-hidden="true"></a> オマケ: マクロで再現する方法</h3>
<p data-line="327" class="code-line">キー入力中のAML誤爆防止以外は、Input Processorを使わなくても、pmw3610-driverのAML+マクロで再現できます。</p>
<p data-line="329" class="code-line">今あえてInput Processorを使わずにpmw3610-driverのAML+マクロで頑張る理由は特にありませんが、過去にInput Processorの不具合でフリーズすることがあった(現在は修正済み)ため、そういった場合の代替手段として使用できました。</p>
<p data-line="331" class="code-line">ZMKは一見融通が利かないように見えて、実は大抵のことはマクロ+レイヤー移動で解決できてしまいます。ZMKのそういうところの面白さや魅力を感じていただければ幸いです。</p>
<h4 id="%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-2" data-line="333" class="code-line">
<a class="header-anchor-link" href="#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-2" aria-hidden="true"></a> 設定方法</h4>
<p data-line="334" class="code-line"><code>exit_AML</code>を仕込んだ<code>kp</code>、<code>mt</code>、<code>mo</code>、<code>lt</code>を作り、代わりに使います。<br>
タイムアウトに関連する動作はSticky Layer(<code>sl</code>)を組み合わせることで作れます。</p>
<p data-line="337" class="code-line">この<code>mt</code>/<code>lt</code>ではキータップ+長押しで連打が効かなくなりますが、hold時のみAML解除するものを使うと回避できます。</p>
<p data-line="339" class="code-line">「マウスキーを押したらタイムアウトを延長する」「マウスキーを押すまでマウスレイヤーに留まる」には、<code>mkp_exit_AML</code>を使います。</p>
<div class="code-block-container">
<div class="code-block-filename-container"><span class="code-block-filename">roBa.keymap</span></div>
<pre class="language-dts"><code class="language-dts code-line" data-line="341">#define MOUSE 5

/{
    macros {
        exit_AML: exit_AML {
            compatible = "zmk,behavior-macro";
            wait-ms = &lt;0&gt;;
            tap-ms = &lt;0&gt;;
            #binding-cells = &lt;0&gt;;
            bindings = &lt;&amp;tog_off MOUSE&gt;;
            label = "exit_AML";
        };

        kp_exit_AML: kp_exit_AML {
            compatible = "zmk,behavior-macro-one-param";
            wait-ms = &lt;0&gt;;
            tap-ms = &lt;0&gt;;
            #binding-cells = &lt;1&gt;;
            bindings = &lt;&amp;macro_param_1to1 &amp;kp MACRO_PLACEHOLDER &amp;exit_AML&gt;;
            label = "KP_exit_AML";
        };

        mod_exit_AML: mod_exit_AML {
            compatible = "zmk,behavior-macro-one-param";
            wait-ms = &lt;0&gt;;
            tap-ms = &lt;0&gt;;
            #binding-cells = &lt;1&gt;;
            bindings =
                &lt;&amp;macro_press&gt;,
                &lt;&amp;macro_param_1to1 &amp;kp MACRO_PLACEHOLDER&gt;,
                &lt;&amp;macro_tap&gt;,
                &lt;&amp;exit_AML&gt;,
                &lt;&amp;macro_pause_for_release&gt;,
                &lt;&amp;macro_release&gt;,
                &lt;&amp;macro_param_1to1 &amp;kp MACRO_PLACEHOLDER&gt;;

            label = "MOD_exit_AML";
        };

        mo_exit_AML: mo_exit_AML {
            compatible = "zmk,behavior-macro-one-param";
            wait-ms = &lt;0&gt;;
            tap-ms = &lt;0&gt;;
            #binding-cells = &lt;1&gt;;
            bindings =
                &lt;&amp;macro_press&gt;,
                &lt;&amp;macro_param_1to1 &amp;mo MACRO_PLACEHOLDER&gt;,
                &lt;&amp;macro_tap&gt;,
                &lt;&amp;exit_AML&gt;,
                &lt;&amp;macro_pause_for_release&gt;,
                &lt;&amp;macro_release&gt;,
                &lt;&amp;macro_param_1to1 &amp;mo MACRO_PLACEHOLDER&gt;,
                &lt;&amp;macro_tap&gt;;

            label = "MO_exit_AML";
        };

        mkp_exit_AML: mkp_exit_AML {
            compatible = "zmk,behavior-macro-one-param";
            #binding-cells = &lt;1&gt;;
            bindings =
                &lt;&amp;macro_press&gt;,
                &lt;&amp;macro_param_1to1 &amp;mkp MACRO_PLACEHOLDER&gt;,
                &lt;&amp;macro_pause_for_release&gt;,
                &lt;&amp;macro_release&gt;,
                &lt;&amp;macro_param_1to1 &amp;mkp MACRO_PLACEHOLDER&gt;,
                &lt;&amp;macro_tap&gt;,
                &lt;&amp;sl_250 MOUSE&gt;;

            label = "MKP_EXIT_AML";
        };
    };

    behaviors {
        sl_250: sl_250 {
            compatible = "zmk,behavior-sticky-key";
            label = "SL_250";
            bindings = &lt;&amp;mo&gt;;
            #binding-cells = &lt;1&gt;;
            release-after-ms = &lt;250&gt;;
        };

        tog_off: toggle_layer_off {
            compatible = "zmk,behavior-toggle-layer";
            #binding-cells = &lt;1&gt;;
            display-name = "Toggle Layer Off";
            toggle-mode = "off";
        };

        lt_exit_AML: lt_exit_AML {
            compatible = "zmk,behavior-hold-tap";
            label = "LT_exit_AML";
            bindings = &lt;&amp;mo_exit_AML&gt;, &lt;&amp;kp_exit_AML&gt;;

            #binding-cells = &lt;2&gt;;
            tapping-term-ms = &lt;200&gt;;
            quick-tap-ms = &lt;200&gt;;
            flavor = "balanced";
        };

        lt_exit_AML_on_hold: lt_exit_AML_on_hold {
            compatible = "zmk,behavior-hold-tap";
            label = "LT_exit_AML_ON_HOLD";
            bindings = &lt;&amp;mo_exit_AML&gt;, &lt;&amp;kp&gt;;

            #binding-cells = &lt;2&gt;;
            tapping-term-ms = &lt;200&gt;;
            quick-tap-ms = &lt;200&gt;;
            flavor = "balanced";
        };

        mt_exit_AML: mt_exit_AML {
            compatible = "zmk,behavior-hold-tap";
            label = "MT_exit_AML";
            bindings = &lt;&amp;mod_exit_AML&gt;, &lt;&amp;kp_exit_AML&gt;;

            #binding-cells = &lt;2&gt;;
            tapping-term-ms = &lt;200&gt;;
            flavor = "balanced";
            quick-tap-ms = &lt;200&gt;;
        };

        mt_exit_AML_on_tap: mt_exit_AML_on_tap {
            compatible = "zmk,behavior-hold-tap";
            label = "MT_exit_AML_ON_TAP";
            bindings = &lt;&amp;kp&gt;, &lt;&amp;kp_exit_AML&gt;;

            #binding-cells = &lt;2&gt;;
            tapping-term-ms = &lt;200&gt;;
            flavor = "balanced";
            quick-tap-ms = &lt;200&gt;;
        };
    };
}
</code></pre>
</div><hr data-line="478" class="code-line">
<p data-line="479" class="code-line">この記事はroBaで書きました。</p>
<section class="footnotes">
<span class="footnotes-title">脚注</span>
<ol class="footnotes-list">
<li id="fn-85a1-1" class="footnote-item">
<p data-line="13" class="code-line"><a href="https://github.com/negokaz/keyball/pull/2" target="_blank" rel="nofollow noopener noreferrer">https://github.com/negokaz/keyball/pull/2</a> <a href="#fnref-85a1-1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn-85a1-2" class="footnote-item">
<p data-line="31" class="code-line"><a href="https://github.com/inorichi/zmk-pmw3610-driver" target="_blank" rel="nofollow noopener noreferrer">zmk-pmw3610-driver</a>はZMKでPMW3610を使用するためのドライバーです。PMW3610はマウスセンサーで、<a href="https://github.com/kumamuk-git/roBa" target="_blank" rel="nofollow noopener noreferrer">roBa</a>や<a href="https://github.com/sayu-hub/zmk-config-moNa2" target="_blank" rel="nofollow noopener noreferrer">moNa2</a>といった多くのZMKトラボ付きキーボードで採用されています。zmk-pmw3610-driverにはいくつか派生(fork)があり、<a href="https://github.com/badjeff/zmk-pmw3610-driver" target="_blank" rel="nofollow noopener noreferrer">badjeff氏のフォーク</a>などでは、Input ProcessorでAMLが可能になったので、AML機能が削除されています。 <a href="#fnref-85a1-2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn-85a1-3" class="footnote-item">
<p data-line="277" class="code-line"><a href="https://zmk.dev/docs/keymaps/behaviors/layers#toggle-layer" target="_blank" rel="nofollow noopener noreferrer">ZMKの公式ドキュメント</a>に記載されているものです。<a href="https://github.com/zmkfirmware/zmk/pull/2943" target="_blank" rel="nofollow noopener noreferrer">これらを標準搭載しようというPR</a>があるので、これがマージされれば自分で定義しなくても使えるようになります。 <a href="#fnref-85a1-3" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div><span style="display:block;height:1.5rem;flex-shrink:0"></span><a class="Button_secondary__cM38g Button_baseStyle__Vhn6Y Button_small__ErWhv" rel="noopener noreferrer" target="_blank" href="https://github.com/kot149/zenn-contents/blob/main/articles/zmk-auto-mouse-layer.md"><span class="Button_iconLeft__Hqq_M"><svg xml:space="preserve" viewBox="0 0 27 27" height="20" width="20"><path fill="currentColor" d="M13.4,1.2C7,1,1.8,6,1.7,12.4c0,0.1,0,0.4,0,0.5c0,5.1,3.2,9.8,8.2,11.5c0.6,0.1,0.7-0.2,0.7-0.6s0-1.8,0-2.9 c0,0-3.3,0.6-4-1.5c0,0-0.6-1.3-1.3-1.8c0,0-1.1-0.7,0.1-0.7c0.7,0.1,1.5,0.6,1.8,1.2c0.6,1.2,2.2,1.7,3.4,1h0.1 c0.1-0.6,0.4-1.2,0.7-1.6C8.7,17.1,6,16.9,6,12.3c0-1.1,0.5-2.1,1.2-2.8c0-1.1,0-2.2,0.3-3.2c1-0.4,3.3,1.3,3.3,1.3c2-0.6,4-0.6,6,0 c0,0,2.2-1.6,3.2-1.2c0.5,1,0.5,2.2,0.1,3.2c0.7,0.7,1.2,1.8,1.2,2.8c0,4.5-2.8,5-5.5,5.2c0.6,0.6,0.9,1.3,0.7,2.2c0,1.7,0,3.5,0,4 s0.2,0.6,0.7,0.6c4.9-1.7,8.2-6.2,8-11.5c0.1-6.4-5.1-11.6-11.6-11.6C13.5,1.2,13.4,1.2,13.4,1.2z"></path></svg></span>GitHubで編集を提案</a><div class="View_actions__s_UJk" id="share"><div class="LikeButton_container__YlckE style-large"><button aria-label="いいね" class="LikeButton_button__ZwdG4" data-pressed="false"><svg class="LikeButton_svgLike__Gl0Sz" viewBox="0 0 110 110"><path class="LikeButton_svgLikeLine__f9txR" d="M73,24a23.78,23.78,0,0,0-15.89,6.19,3.14,3.14,0,0,1-4.18,0A23.81,23.81,0,0,0,37,24a22,22,0,0,0-22,22c0,16.67,19.64,32.82,25.11,37.93,2.84,2.65,6.15,5.64,8.92,8.13a8.9,8.9,0,0,0,11.9,0c2.77-2.49,6.07-5.48,8.91-8.13C75.37,78.81,95,62.66,95,46A22,22,0,0,0,73,24Z" fill="currentColor"></path><path class="LikeButton_svgLikeInner__uiexS" d="M66.25,76.42c-.71.64-1.32,1.2-1.82,1.67-2.51,2.33-5.39,5-7.94,7.25a2.21,2.21,0,0,1-3,0C51,83,48.1,80.42,45.59,78.09c-.5-.47-1.12-1-1.82-1.67C38.09,71.29,23,57.67,23,46A14,14,0,0,1,37,32a15.92,15.92,0,0,1,11.65,5.23l4.73,5a2.2,2.2,0,0,0,3.23,0l4.72-5A16.06,16.06,0,0,1,73,32,14,14,0,0,1,87,46C87,57.67,71.93,71.29,66.25,76.42Z" fill="currentColor"></path><g class="LikeButton_svgLikeDecoration__78UjB"><circle cx="41.5" cy="9.5" fill="#3ea8ff" r="3.5"></circle><circle cx="98.5" cy="26.5" fill="#ffdc6e" r="3.5"></circle><circle cx="13" cy="19" fill="#c067f4" r="5"></circle><circle cx="77" cy="9" fill="#f76685" r="5"></circle><circle cx="26.5" cy="92.5" fill="#f76685" r="3.5"></circle><circle cx="105.5" cy="48.5" fill="#c067f4" r="3.5"></circle><circle cx="4.5" cy="60.5" fill="#3ea8ff" r="3.5"></circle><circle cx="94.5" cy="73.5" fill="#3ea8ff" r="1.5"></circle><circle cx="16.5" cy="75.5" fill="#ffdc6e" r="1.5"></circle><circle cx="78.5" cy="91.5" fill="#ffdc6e" r="1.5"></circle></g></svg></button></div><div class="View_menuAndShareButtonsContainer__PMtHU"><div class="View_menu__wgMxq"><button aria-label="その他の操作" class="PopoverMenuButton_menuButton__hKCa_"><svg viewBox="0 0 27 27" height="16" width="16"><path fill="currentColor" d="M12.74,20.53,3.48,11.35a.75.75,0,0,1,0-1.07L4.71,9.05a.75.75,0,0,1,1.07,0l7.49,7.41,7.49-7.41a.74.74,0,0,1,1.06,0l1.24,1.23a.77.77,0,0,1,0,1.07L13.8,20.53A.74.74,0,0,1,12.74,20.53Z"></path></svg></button></div><div class="ShareButtonsExperimental_container__CrtBj" style="flex-direction:row;align-items:center"><a aria-label="X(Twitter)にポスト" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgTwitterHorizontal__5xDGM ShareButtonsExperimental_svgTwitterBase__8FrNq" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://twitter.com/intent/tweet?url=https://zenn.dev/kot149/articles/zmk-auto-mouse-layer&amp;text=ZMK%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%A5%B5%E3%82%81%E3%82%8B%EF%BD%9Ckot149&amp;hashtags=zenn" id="gtm-article-footer-tweet" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clipPath></defs></svg></a><a aria-label="Facebookに投稿" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgFacebookHorizontal__MpfBm ShareButtonsExperimental_svgFacebookBase___gDOW" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="http://www.facebook.com/sharer.php?u=https://zenn.dev/kot149/articles/zmk-auto-mouse-layer" id="gtm-article-footer-facebook" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="28" height="29" fill="none" viewBox="0 0 28 29"><g clip-path="url(#a)"><path fill="currentColor" d="M28 14.7812C28 7.02084 21.7319 0.729736 14 0.729736C6.26808 0.729736 0 7.02084 0 14.7812C0 21.3707 4.52032 26.9002 10.6182 28.4189V19.0753H7.73136V14.7812H10.6182V12.9309C10.6182 8.14833 12.7747 5.93158 17.453 5.93158C18.34 5.93158 19.8705 6.10637 20.4966 6.28061V10.1729C20.1662 10.138 19.5922 10.1206 18.8793 10.1206C16.5838 10.1206 15.6968 10.9935 15.6968 13.2625V14.7812H20.2698L19.4841 19.0753H15.6968V28.7297C22.629 27.8895 28.0006 21.9654 28.0006 14.7812H28Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0H28V28H0z" transform="translate(0 .73)"></path></clipPath></defs></svg></a><a aria-label="はてなブックマークに登録" class="ShareButtonsExperimental_button__d9aXF ShareButtonsExperimental_svgHatenaBookmarkHorizontal__ccpWn ShareButtonsExperimental_svgHatenaBookmarkBase__VXz6p" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://b.hatena.ne.jp/add?mode=confirm&amp;url=https://zenn.dev/kot149/articles/zmk-auto-mouse-layer&amp;title=ZMK%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%A5%B5%E3%82%81%E3%82%8B%EF%BD%9Ckot149" id="gtm-article-footer-hatena-bookmark" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28"><path fill="currentColor" fill-rule="evenodd" d="M5.4999 0.729736H21.5001C24.5376 0.729736 27 3.19213 27 6.22964V22.2298C27 25.2673 24.5376 27.7297 21.5001 27.7297H5.4999C2.46239 27.7297 0 25.2673 0 22.2298V6.22964C0 3.19213 2.46239 0.729736 5.4999 0.729736ZM12.98 13.7472C13.8521 13.8136 14.5319 14.1209 15.0212 14.6673V14.6679C15.512 15.2127 15.7572 15.9444 15.7572 16.8543C15.7572 17.5126 15.62 18.0877 15.3436 18.5867C15.0692 19.084 14.6756 19.4712 14.1604 19.7433C13.7441 19.9658 13.2289 20.1278 12.6155 20.2245C12.001 20.3179 10.9966 20.3665 9.6039 20.3665H6.13656V8.09392H9.50184C10.8859 8.09392 11.8503 8.13875 12.4016 8.22623C12.9503 8.31695 13.4206 8.4703 13.8164 8.68792C14.269 8.93902 14.6129 9.27437 14.8527 9.69341C15.0865 10.1151 15.2069 10.6028 15.2069 11.1546C15.2069 11.8512 15.0309 12.4053 14.6761 12.813C14.3197 13.2261 13.756 13.5355 12.98 13.7472ZM9.96192 10.8144H9.24372H9.24318V13.2768H9.91116C10.7352 13.2768 11.2984 13.1856 11.6073 13.0058C11.9124 12.8227 12.0663 12.5273 12.0663 12.0667C12.0663 11.6061 11.9216 11.2821 11.6375 11.0947C11.3497 10.9084 10.7919 10.8144 9.96192 10.8144ZM10.4128 18.1514C11.2028 18.1514 11.7661 18.0531 12.0928 17.8523V17.8528C12.4227 17.653 12.5863 17.3209 12.5863 16.8581C12.5863 16.3408 12.4367 15.9806 12.1338 15.7765C11.8357 15.5724 11.2747 15.4703 10.463 15.4703H9.24372V18.1514H10.4128ZM19.3093 17.257C18.4502 17.257 17.7547 17.9525 17.7547 18.8111C17.7547 19.6697 18.4507 20.3658 19.3093 20.3658C20.1679 20.3658 20.8634 19.6697 20.8634 18.8111C20.8634 17.9525 20.1668 17.257 19.3093 17.257ZM17.9593 8.09318H20.6593V16.2753H17.9593V8.09318Z" clip-rule="evenodd"></path></svg></a></div></div></div><span style="display:block;height:2rem;flex-shrink:0"></span><aside class="View_authorInfo__F19rR"><div class="ProfileCard_container__YfvQl"><a class="ProfileCard_avatar__tIJpR" href="/kot149"><img alt="kot149" class="AvatarImage_plain__Fgp4R " height="80" loading="lazy" referrerPolicy="no-referrer" src="https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg" width="80"/></a><div class="ProfileCard_name__qXamf"><a class="ProfileCard_displayName__gRUeY" href="/kot149">kot149</a></div><div class="ProfileCard_content__1w905"><div class="ProfileCard_actions__2ZjZ8"><span class="ProfileCard_follow__ng60N"></span><a aria-label="@kot149" class="GithubLink_link__3iaUH" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://github.com/kot149" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg xml:space="preserve" viewBox="0 0 27 27" aria-label="GitHub"><path fill="currentColor" d="M13.4,1.2C7,1,1.8,6,1.7,12.4c0,0.1,0,0.4,0,0.5c0,5.1,3.2,9.8,8.2,11.5c0.6,0.1,0.7-0.2,0.7-0.6s0-1.8,0-2.9 c0,0-3.3,0.6-4-1.5c0,0-0.6-1.3-1.3-1.8c0,0-1.1-0.7,0.1-0.7c0.7,0.1,1.5,0.6,1.8,1.2c0.6,1.2,2.2,1.7,3.4,1h0.1 c0.1-0.6,0.4-1.2,0.7-1.6C8.7,17.1,6,16.9,6,12.3c0-1.1,0.5-2.1,1.2-2.8c0-1.1,0-2.2,0.3-3.2c1-0.4,3.3,1.3,3.3,1.3c2-0.6,4-0.6,6,0 c0,0,2.2-1.6,3.2-1.2c0.5,1,0.5,2.2,0.1,3.2c0.7,0.7,1.2,1.8,1.2,2.8c0,4.5-2.8,5-5.5,5.2c0.6,0.6,0.9,1.3,0.7,2.2c0,1.7,0,3.5,0,4 s0.2,0.6,0.7,0.6c4.9-1.7,8.2-6.2,8-11.5c0.1-6.4-5.1-11.6-11.6-11.6C13.5,1.2,13.4,1.2,13.4,1.2z"></path></svg></a><a aria-label="@kot149_" class="XLink_link__Sn3ha" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://x.com/kot149_" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28" aria-label="X(Twitter)"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clipPath></defs></svg></a></div></div></div></aside></div></div><div id="discuss"><div class="ArticleComments_commentsContainer__kOO0n"><section class="ArticleComments_comments__y4Azs"><div class="ArticleComments_commentsHeadingContainer__v8IYT"><h3 class="Heading_size-md__Zg0Hr Heading_centered__lNLF_">Discussion</h3></div><div><div class="ArticleComments_commentItemContainer__K2ijm"><article class="ThreadItemContent_parentItem__2BweX" id="comment-77b7d7b9d2e299"><header class="ThreadHeader_header__rscC4"><a class="ThreadHeader_userAvatar__zumMm" href="/katsujp"><img alt="katsu.jp" class="AvatarImage_plain__Fgp4R " height="36" loading="lazy" referrerPolicy="no-referrer" src="https://lh3.googleusercontent.com/a/ACg8ocI84AerD7pL1bUBlVPCLc3-56pCXzr4Cr3imtoeRKH00vjUa-xg=s96-c" width="36"/></a><a class="ThreadHeader_userName__TmgaQ" href="/katsujp">katsu.jp</a><a class="ThreadHeader_dateContainer__349dg" href="#comment-77b7d7b9d2e299"><time aria-label="2025年6月24日 23時43分" data-tooltip-for-desktop="true" data-tooltip-position="top" dateTime="2025-06-24T14:43:22+00:00" role="tooltip">6ヶ月前</time></a><div class="ThreadHeader_actionContainer__8UItF"><button aria-label="メニューを開く" class="PopoverMenuButton_menuButton__hKCa_"><svg viewBox="0 0 27 27" height="16" width="16"><path fill="currentColor" d="M12.74,20.53,3.48,11.35a.75.75,0,0,1,0-1.07L4.71,9.05a.75.75,0,0,1,1.07,0l7.49,7.41,7.49-7.41a.74.74,0,0,1,1.06,0l1.24,1.23a.77.77,0,0,1,0,1.07L13.8,20.53A.74.74,0,0,1,12.74,20.53Z"></path></svg></button></div></header><div class="ThreadItemContent_content__Ivb_O"><div class="znc BodyCommentContent_bodyCommentContainer__PFlLd"><p data-line="0" class="code-line">roBaish、Zonkeyを愛用していて、キー入力中のトラックボール誤爆に困っていたので、こちらの記事がめちゃくちゃ参考になりました。<br>
本当にありがとうございました！</p>
</div><footer class="ThreadItemContent_footer__WEMyQ"><div class="LikeButton_container__YlckE style-icon"><button aria-label="いいね" class="LikeButton_button__ZwdG4" data-pressed="false"><svg class="LikeButton_svgLike__Gl0Sz" viewBox="0 0 110 110"><path class="LikeButton_svgLikeLine__f9txR" d="M73,24a23.78,23.78,0,0,0-15.89,6.19,3.14,3.14,0,0,1-4.18,0A23.81,23.81,0,0,0,37,24a22,22,0,0,0-22,22c0,16.67,19.64,32.82,25.11,37.93,2.84,2.65,6.15,5.64,8.92,8.13a8.9,8.9,0,0,0,11.9,0c2.77-2.49,6.07-5.48,8.91-8.13C75.37,78.81,95,62.66,95,46A22,22,0,0,0,73,24Z" fill="currentColor"></path><path class="LikeButton_svgLikeInner__uiexS" d="M66.25,76.42c-.71.64-1.32,1.2-1.82,1.67-2.51,2.33-5.39,5-7.94,7.25a2.21,2.21,0,0,1-3,0C51,83,48.1,80.42,45.59,78.09c-.5-.47-1.12-1-1.82-1.67C38.09,71.29,23,57.67,23,46A14,14,0,0,1,37,32a15.92,15.92,0,0,1,11.65,5.23l4.73,5a2.2,2.2,0,0,0,3.23,0l4.72-5A16.06,16.06,0,0,1,73,32,14,14,0,0,1,87,46C87,57.67,71.93,71.29,66.25,76.42Z" fill="currentColor"></path><g class="LikeButton_svgLikeDecoration__78UjB"><circle cx="41.5" cy="9.5" fill="#3ea8ff" r="3.5"></circle><circle cx="98.5" cy="26.5" fill="#ffdc6e" r="3.5"></circle><circle cx="13" cy="19" fill="#c067f4" r="5"></circle><circle cx="77" cy="9" fill="#f76685" r="5"></circle><circle cx="26.5" cy="92.5" fill="#f76685" r="3.5"></circle><circle cx="105.5" cy="48.5" fill="#c067f4" r="3.5"></circle><circle cx="4.5" cy="60.5" fill="#3ea8ff" r="3.5"></circle><circle cx="94.5" cy="73.5" fill="#3ea8ff" r="1.5"></circle><circle cx="16.5" cy="75.5" fill="#ffdc6e" r="1.5"></circle><circle cx="78.5" cy="91.5" fill="#ffdc6e" r="1.5"></circle></g></svg></button><span class="LikeButton_likedCount__nJzwt">1</span></div><button class="ThreadItemContent_reply___ZYlC"><svg viewBox="0 0 27 27" aria-label="コメント" class="ThreadItemContent_replySvg__Hn2Qs" height="19" width="19"><path fill="currentColor" d="M5.9,25.3a1.27,1.27,0,0,1-.6-.1,1.68,1.68,0,0,1-.9-1.3V18.8a8.53,8.53,0,0,1-2.2-6.4C2.2,6.5,6.9,2.3,13.5,2.3S24.8,6.6,24.8,12.4,20,22.6,13.5,22.6a6.36,6.36,0,0,1-2.5-.3L6.7,25A1.6,1.6,0,0,1,5.9,25.3ZM13.5,4.7c-5.2,0-8.8,3.2-8.8,7.7,0,2.4.5,3.7,1.8,5a1.09,1.09,0,0,1,.4.9V22l3.3-2.1a1.38,1.38,0,0,1,1.1-.1,4.49,4.49,0,0,0,2.3.4c5.2,0,8.8-3.2,8.8-7.7S18.7,4.7,13.5,4.7Z"></path></svg><span>返信</span></button></footer></div><div class="ThreadItemContent_addReplyContainer__cV93C"><button class="ThreadItemContent_addReplyButton__2Y8xI">返信を追加</button></div></article></div></div></section></div></div></section><aside class="View_sidebarContainer__YwcNH"><div class="ArticleSidebar_container__jSRJw"><div><div class="ArticleSidebar_user__vJ7nz ArticleSidebar_sidebarCard__AtM_Z"><div class="SidebarUserBio_container__iWemi"><a href="/kot149"><img alt="kot149" class="AvatarImage_border__pDIjF AvatarImage_plain__Fgp4R " height="60" loading="lazy" referrerPolicy="no-referrer" src="https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg" width="60"/></a><div class="SidebarUserBio_author__cM7pP"><a class="SidebarUserBio_name__0zFdT" href="/kot149">kot149</a><div class="SidebarUserBio_actions__oFupD"><a aria-label="@kot149" class="GithubLink_link__3iaUH" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://github.com/kot149" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg xml:space="preserve" viewBox="0 0 27 27" aria-label="GitHub"><path fill="currentColor" d="M13.4,1.2C7,1,1.8,6,1.7,12.4c0,0.1,0,0.4,0,0.5c0,5.1,3.2,9.8,8.2,11.5c0.6,0.1,0.7-0.2,0.7-0.6s0-1.8,0-2.9 c0,0-3.3,0.6-4-1.5c0,0-0.6-1.3-1.3-1.8c0,0-1.1-0.7,0.1-0.7c0.7,0.1,1.5,0.6,1.8,1.2c0.6,1.2,2.2,1.7,3.4,1h0.1 c0.1-0.6,0.4-1.2,0.7-1.6C8.7,17.1,6,16.9,6,12.3c0-1.1,0.5-2.1,1.2-2.8c0-1.1,0-2.2,0.3-3.2c1-0.4,3.3,1.3,3.3,1.3c2-0.6,4-0.6,6,0 c0,0,2.2-1.6,3.2-1.2c0.5,1,0.5,2.2,0.1,3.2c0.7,0.7,1.2,1.8,1.2,2.8c0,4.5-2.8,5-5.5,5.2c0.6,0.6,0.9,1.3,0.7,2.2c0,1.7,0,3.5,0,4 s0.2,0.6,0.7,0.6c4.9-1.7,8.2-6.2,8-11.5c0.1-6.4-5.1-11.6-11.6-11.6C13.5,1.2,13.4,1.2,13.4,1.2z"></path></svg></a><a aria-label="@kot149_" class="XLink_link__Sn3ha" data-tooltip-for-desktop="true" data-tooltip-position="bottom" href="https://x.com/kot149_" rel="nofollow noopener noreferrer" role="tooltip" target="_blank"><svg width="27" height="28" fill="none" viewBox="0 0 27 28" aria-label="X(Twitter)"><g clip-path="url(#a)"><path fill="currentColor" d="M16.0687 11.7356L26.12 0H23.7382L15.0106 10.1899L8.03988 0H0L10.5411 15.4089L0 27.7155H2.38199L11.5985 16.9546L18.9601 27.7155H27L16.0681 11.7356H16.0687ZM12.8062 15.5447L11.7382 14.0103L3.24025 1.80106H6.89884L13.7568 11.6543L14.8248 13.1887L23.7393 25.9963H20.0807L12.8062 15.5452V15.5447Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0H27V27.73H0z"></path></clipPath></defs></svg></a></div></div></div></div></div><span style="display:block;height:1.5rem;flex-shrink:0"></span><div class="ArticleSidebar_sticky__W61mq"><div style="display:flex;gap:1.5rem;flex-direction:column;align-items:stretch;flex-wrap:nowrap"><div class="ArticleSidebarToc_toc__dUPn8"><div class="ArticleSidebarToc_tocTitle__A3VjO">目次</div><div class="ArticleToc_toc__WF75u"><ol class="ol-depth-1"><li><a href="#%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%A8%E3%81%AF">オートマウスレイヤーとは</a></li><li><a href="#zmk%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC">ZMKにおけるオートマウスレイヤー</a></li><li><a href="#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95">設定方法</a><ol class="ol-depth-2"><li><a href="#pmw3610-driver%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC">PMW3610 Driverのオートマウスレイヤー</a></li><li><a href="#input-processor%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC">Input Processorを使用したオートマウスレイヤー</a></li><li><a href="#%E9%9D%9E%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E9%96%A2%E4%BF%82%E3%81%AA%E3%81%8F%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%8A%9C%E3%81%91%E3%82%8B">非マウスキーを押したらタイムアウトに関係なくマウスレイヤーを抜ける</a></li><li><a href="#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B">マウスキーを押したらタイムアウトを延長する</a></li><li><a href="#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%99%E3%81%BE%E3%81%A7%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AB%E7%95%99%E3%81%BE%E3%82%8B">マウスキーを押すまでマウスレイヤーに留まる</a></li><li><a href="#%E3%82%AD%E3%83%BC%E5%85%A5%E5%8A%9B%E4%B8%AD%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%AA%A4%E7%88%86%E9%98%B2%E6%AD%A2">キー入力中のオートマウスレイヤー誤爆防止</a></li><li><a href="#shift%2B%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%8B%95%E4%BD%9C%E6%94%B9%E5%96%84">Shift+クリックの動作改善</a></li><li><a href="#%E3%82%AA%E3%83%9E%E3%82%B1%3A-%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%A7%E5%86%8D%E7%8F%BE%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">オマケ: マクロで再現する方法</a></li></ol></li></ol></div></div></div></div></div></aside></div></div></div></div><div id="related-contents"></div></article><footer class="AppFooter_footer__pqSnY"><div class="Container_wide__ykGLh Container_common__figYY"><div class="AppFooter_inner__uGxbT" data-nosnippet="true"><div class="AppFooter_brandingColumn__BikTT"><a class="ZennLogo_logoLink__NJS2l" href="/"><svg viewBox="0 0 377.4 88.3" aria-label="Zenn | エンジニアのための情報共有コミュニティ" class="ZennLogo_logoSvg__yOhcg" height="20" width="85"><g fill="currentColor"><path d="M233 56.8h-39c.5 3.5 2.2 6.8 4.8 9.2 2.7 2.3 6.2 3.5 9.8 3.4 2.8 0 5.6-.5 8.2-1.7 2.5-1.1 4.8-2.8 6.5-5l8.2 9.5c-2.5 3.4-5.7 6.1-9.5 7.9-4.6 2.2-9.6 3.3-14.7 3.2-5.7.1-11.4-1.2-16.5-4-4.5-2.5-8.2-6.3-10.7-10.9s-3.8-9.8-3.7-15.1v-2.2c-.1-5.7 1.1-11.3 3.5-16.5 2.2-4.7 5.7-8.6 10.1-11.3 4.7-2.8 10.1-4.2 15.5-4.1 5.2-.1 10.3 1.1 14.9 3.7 4.1 2.5 7.4 6.2 9.4 10.5 2.2 5.1 3.3 10.5 3.2 16.1V56.8zM216.1 43.9c.1-2.9-.9-5.7-2.8-7.9-1.8-1.9-4.4-2.9-7.9-2.9-2.9-.1-5.8 1.1-7.7 3.2-2 2.6-3.3 5.7-3.6 9h22V43.9zM128.3 67.9h36.1v14.7h-56.9V72l35.8-54.3h-36.2V2.9h56.6v10.4L128.3 67.9zM248.8 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1s-12.4 5.5-12.4 16.1v30.7h-15.8L248.8 50.7 248.8 50.7zM320.3 50.7c0-19.1 12.7-29.2 28.2-29.2s27.9 10.1 27.9 29.2V82h-16V51.4c0-10.6-4.8-16.1-12-16.1S336 40.8 336 51.4v30.7h-15.8L320.3 50.7 320.3 50.7z"></path></g><path fill="#3EA8FF" d="M2.4 83.3h17c.9 0 1.7-.5 2.2-1.2L68.4 5.2C69 4.2 68.3 3 67.1 3H51c-.8 0-1.5.4-1.9 1.1L1.6 81.9C1.3 82.5 1.7 83.3 2.4 83.3zM61 82.1l22.1-35.5c.7-1.1-.1-2.5-1.4-2.5H65.7c-.6 0-1.2.3-1.5.8L41.5 81.2c-.6.9.1 2.1 1.2 2.1h16.3C59.8 83.3 60.6 82.9 61 82.1z" class="st0"></path></svg></a><p class="AppFooter_siteDescription__NWGP2">エンジニアのための<br aria-hidden="true"/>情報共有コミュニティ</p></div><div class="AppFooter_navColumns__ahV9g"><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">About</h4><ul><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/about">Zennについて</a></div></li><li><a href="https://classmethod.jp" rel="nofollow noopener noreferrer" target="_blank">運営会社</a></li><li><a href="https://info.zenn.dev" rel="nofollow noopener noreferrer" target="_blank">お知らせ・リリース</a></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/events">イベント</a></div></li></ul></nav><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">Guides</h4><ul><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/manual">使い方</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/biz-lp">法人向けメニュー</a><span class="NewLabel_newLabel__gxw6E NewLabel_newLabelBase__Q5W_C">New</span></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/publications">Publication / Pro</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/faq">よくある質問</a></div></li></ul></nav><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">Links</h4><ul><li><a href="https://twitter.com/zenn_dev" rel="nofollow noopener noreferrer" target="_blank">X(Twitter)</a></li><li><a href="https://github.com/zenn-dev" rel="nofollow noopener noreferrer" target="_blank">GitHub</a></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/mediakit">メディアキット</a></div></li></ul></nav><nav class="AppFooter_navColumn__47qTk"><h4 class="AppFooter_navColumnTitle__vVeiQ">Legal</h4><ul><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/terms">利用規約</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/privacy">プライバシーポリシー</a></div></li><li><div style="display:flex;gap:0.5rem;flex-direction:row;align-items:center;flex-wrap:nowrap"><a href="/terms/transaction-law">特商法表記</a></div></li></ul></nav></div></div><div class="AppFooter_copyright__J_Jbe" data-nosnippet="true"><div class="AnnouncementPopUp_hiddenWrapper__ThDWT"><div aria-hidden="true" class="PopUp_popup__lIgfz AnnouncementPopUp_container__Pb5q2"><div></div></div></div><a href="https://classmethod.jp/"><svg viewBox="0 0 271 60" class="AppFooter_classmethodLogo__1RFuV" height="25"><path fill="currentColor" d="M264.636 3.1617C265.475 3.16128 266.279 3.49393 266.873 4.08651C267.466 4.67909 267.8 5.48309 267.801 6.32175V53.0703C267.801 53.5668 267.703 54.0585 267.513 54.5171C267.323 54.9758 267.045 55.3926 266.694 55.7437C266.342 56.0948 265.926 56.3733 265.467 56.5633C265.008 56.7533 264.517 56.851 264.02 56.851H6.93132C5.92861 56.851 4.96697 56.4527 4.25795 55.7437C3.54892 55.0347 3.1506 54.073 3.1506 53.0703V6.93139C3.1506 5.92868 3.54892 4.96704 4.25795 4.25802C4.96697 3.54899 5.92861 3.15067 6.93132 3.15067H225.05C225.137 3.15178 225.221 3.17053 225.3 3.20575C225.379 3.24097 225.449 3.29192 225.507 3.35546L233.987 12.76C234.28 13.0541 234.628 13.2875 235.011 13.4467C235.394 13.606 235.805 13.688 236.22 13.688C236.635 13.688 237.046 13.606 237.429 13.4467C237.812 13.2875 238.16 13.0541 238.453 12.76L246.933 3.35231C246.99 3.28778 247.061 3.23616 247.139 3.20086C247.218 3.16555 247.303 3.14737 247.39 3.14752H264.65L264.636 3.1617ZM264.636 7.17095e-05H246.1C246.006 0.000759845 245.914 0.0205359 245.828 0.058188C245.742 0.0958401 245.665 0.150575 245.602 0.219038L237.347 9.39516C237.334 9.40757 237.323 9.4213 237.313 9.43611C237.018 9.72475 236.622 9.88642 236.21 9.88642C235.797 9.88642 235.402 9.72475 235.107 9.43611C235.094 9.42426 235.082 9.41045 235.072 9.39516L226.843 0.239517C226.775 0.162922 226.691 0.10189 226.597 0.0605717C226.504 0.0192536 226.402 -0.00138099 226.3 7.17095e-05H6.93132C5.09302 7.17095e-05 3.33001 0.730333 2.03014 2.03021C0.730262 3.33008 0 5.09309 0 6.93139L0 53.0719C0 54.9102 0.730262 56.6732 2.03014 57.9731C3.33001 59.273 5.09302 60.0032 6.93132 60.0032H264.02C265.858 60.0032 267.621 59.273 268.921 57.9731C270.221 56.6732 270.951 54.9102 270.951 53.0719V6.31545C270.949 4.64114 270.283 3.03602 269.099 1.8521C267.916 0.668193 266.31 0.00215599 264.636 7.17095e-05Z"></path><path fill="currentColor" d="M29.9653 23.8863C30.0769 23.8895 30.1866 23.9161 30.2873 23.9644 30.388 24.0126 30.4775 24.0813 30.5501 24.1662 30.6226 24.251 30.6766 24.3501 30.7086 24.4571 30.7405 24.5641 30.7498 24.6766 30.7357 24.7873V28.3554C30.7357 28.85 30.4679 29.0769 29.9653 29.0769H22.6008C18.4483 29.0769 17.815 30.4789 17.815 36.1657 17.815 41.8526 18.4452 43.2546 22.6008 43.2546H29.9653C30.46 43.2546 30.7357 43.4814 30.7357 43.9351V47.5457C30.7357 48.0892 30.4679 48.316 29.9653 48.4058 27.5367 48.8538 25.0703 49.0648 22.6008 49.0359 12.982 49.0359 11.1326 46.1074 11.1326 36.1642 11.1326 26.2209 12.982 23.2955 22.6008 23.2955 25.0681 23.2729 27.5325 23.4684 29.9653 23.88M39.7637 17.6701C39.9308 17.6701 40.0911 17.7365 40.2093 17.8547 40.3274 17.9729 40.3938 18.1331 40.3938 18.3003V48.4389C40.3938 48.606 40.3274 48.7663 40.2093 48.8845 40.0911 49.0026 39.9308 49.069 39.7637 49.069H34.3872C34.297 49.0756 34.2064 49.0626 34.1216 49.0311 34.0368 48.9995 33.9598 48.9501 33.8959 48.8861 33.8319 48.8221 33.7825 48.7452 33.7509 48.6604 33.7193 48.5756 33.7064 48.485 33.713 48.3948V18.3444C33.7069 18.258 33.7187 18.1713 33.7477 18.0897 33.7766 18.008 33.8221 17.9333 33.8812 17.87 33.9403 17.8067 34.0118 17.7563 34.0913 17.722 34.1708 17.6876 34.2565 17.6699 34.3431 17.6701H39.7637ZM169.156 35.857V37.259C169.156 38.1601 168.888 38.4767 167.711 38.4767H153.533C153.623 42.541 154.709 43.2624 158.636 43.2624H166.679C166.846 43.2624 167.007 43.3288 167.125 43.447 167.243 43.5652 167.309 43.7255 167.309 43.8926V47.6733C167.32 47.8536 167.26 48.031 167.143 48.1682 167.025 48.3054 166.859 48.3917 166.679 48.409 163.831 48.8866 160.945 49.0976 158.058 49.0391 148.934 49.0391 146.716 46.4682 146.716 36.1673 146.716 25.8664 148.929 23.2955 158.058 23.2955 167.187 23.2955 169.121 25.7782 169.168 35.8507M153.499 34.0911H162.437C162.388 30.1166 161.35 29.0785 158.058 29.0785 154.765 29.0785 153.54 30.1166 153.499 34.0911ZM183.056 43.2908H181.07C179.083 43.2908 178.409 42.9332 178.409 40.9877V29.1462H182.706C182.793 29.1449 182.879 29.126 182.958 29.0907 183.037 29.0553 183.108 29.0043 183.167 28.9407 183.226 28.8771 183.271 28.8022 183.3 28.7206 183.33 28.6389 183.342 28.5522 183.337 28.4657V23.9556C183.337 23.7885 183.27 23.6282 183.152 23.51 183.034 23.3919 182.874 23.3255 182.706 23.3255H178.409V18.2971C178.407 18.1308 178.339 17.9719 178.222 17.8542 178.104 17.7366 177.945 17.6694 177.779 17.667H172.355C172.188 17.667 172.028 17.7334 171.91 17.8515 171.791 17.9697 171.725 18.13 171.725 18.2971V43.242C171.725 48.9351 175.246 49.0706 179.129 49.0706 180.418 49.0631 181.704 48.927 182.966 48.6642 183.072 48.6611 183.176 48.6356 183.272 48.5893 183.367 48.5431 183.452 48.4772 183.52 48.396 183.588 48.3147 183.638 48.22 183.667 48.118 183.696 48.0159 183.703 47.909 183.688 47.804V43.9635C183.694 43.8771 183.682 43.7904 183.653 43.7088 183.624 43.6271 183.579 43.5524 183.52 43.4891 183.46 43.4258 183.389 43.3754 183.309 43.3411 183.23 43.3067 183.144 43.289 183.058 43.2892M234.551 36.1673C234.551 46.4603 232.426 49.0391 223.034 49.0391 213.642 49.0391 211.517 46.4682 211.517 36.1673 211.517 25.8664 213.683 23.2955 223.034 23.2955 232.385 23.2955 234.551 25.8255 234.551 36.1673ZM218.248 36.1673C218.248 41.8604 218.922 43.2561 223.034 43.2561 227.146 43.2561 227.867 41.8541 227.867 36.1673 227.867 30.4805 227.193 29.0785 223.034 29.0785 218.875 29.0785 218.248 30.4805 218.248 36.1673ZM202.566 23.6594C199.378 23.1745 196.135 23.1745 192.947 23.6594V18.3034C192.947 18.1363 192.881 17.976 192.763 17.8578 192.645 17.7397 192.484 17.6733 192.317 17.6733H186.892C186.725 17.6733 186.565 17.7397 186.446 17.8578 186.328 17.976 186.262 18.1363 186.262 18.3034V48.3916C186.256 48.478 186.268 48.5647 186.296 48.6463 186.325 48.7279 186.371 48.8027 186.43 48.866 186.489 48.9292 186.561 48.9796 186.64 49.014 186.72 49.0484 186.805 49.0661 186.892 49.0658H192.317C192.484 49.0658 192.645 48.9995 192.763 48.8813 192.881 48.7631 192.947 48.6028 192.947 48.4357V36.1799C192.947 31.3595 193.084 29.091 197.733 29.091 202.382 29.091 202.595 31.3595 202.566 36.1799 202.538 41.0633 202.566 48.4389 202.566 48.4389 202.566 48.606 202.633 48.7663 202.751 48.8844 202.869 49.0026 203.029 49.069 203.196 49.069H208.622C208.789 49.069 208.949 49.0026 209.067 48.8844 209.185 48.7663 209.252 48.606 209.252 48.4389V34.9212C209.252 27.6749 207.505 24.5526 202.568 23.6515M259.138 17.4449C259.225 17.4388 259.311 17.4506 259.393 17.4796 259.475 17.5085 259.549 17.554 259.613 17.6131 259.676 17.6722 259.726 17.7437 259.761 17.8232 259.795 17.9027 259.813 17.9884 259.813 18.075V46.3831C259.813 47.6686 259.269 48.1301 257.922 48.3775 254.951 48.8327 251.949 49.065 248.943 49.0722 239.241 49.0722 237.248 46.4036 237.248 36.2492 237.248 26.0948 239.255 23.3318 248.236 23.3318 249.877 23.2852 251.519 23.3748 253.146 23.5996V18.1112C253.142 18.026 253.155 17.9408 253.185 17.8609 253.215 17.781 253.261 17.7079 253.32 17.6462 253.378 17.5845 253.449 17.5354 253.528 17.5018 253.606 17.4683 253.691 17.4511 253.776 17.4512H259.16L259.138 17.4449ZM249.066 29.1541C244.507 29.1541 243.916 30.3718 243.916 36.202 243.916 41.5312 244.28 43.2908 248.792 43.2908 250.241 43.2893 251.689 43.184 253.124 42.9758V29.1541H249.06 249.066ZM64.2297 31.0649V45.7656C64.2297 47.4496 63.9887 48.0624 61.5343 48.42 58.703 48.8207 55.8479 49.0312 52.9883 49.0501 46.2146 49.0501 42.6465 48.3286 42.5583 41.2398 42.6481 35.1402 45.8113 33.8359 51.8132 33.8359H57.5473V32.2007C57.5473 30.0347 56.1925 29.0863 53.305 29.0863H45.1245C45.0383 29.0852 44.9532 29.0666 44.8744 29.0318 44.7955 28.9969 44.7245 28.9465 44.6657 28.8835 44.6068 28.8205 44.5613 28.7463 44.5319 28.6653 44.5024 28.5843 44.4897 28.4982 44.4943 28.4121V24.7054C44.4901 24.5281 44.5524 24.3557 44.6691 24.2221 44.7857 24.0886 44.9482 24.0036 45.1245 23.9839 47.8206 23.4882 50.5594 23.2624 53.3003 23.3097 62.2385 23.3097 64.2265 26.1972 64.2265 31.0791M52.3519 38.1679C50.0079 38.1679 49.1887 38.9383 49.1887 40.8774 49.1887 43.0435 50.1796 43.6342 53.0262 43.6342 54.544 43.6442 56.0586 43.4921 57.5441 43.1805V38.1679H52.3519ZM76.6021 28.7618H85.994C86.0798 28.7594 86.1643 28.7399 86.2425 28.7047 86.3207 28.6694 86.3912 28.6189 86.4498 28.5562 86.5084 28.4935 86.554 28.4198 86.5839 28.3394 86.6138 28.2589 86.6275 28.1733 86.6241 28.0876V24.4093C86.6093 24.2197 86.5198 24.0437 86.3754 23.92 86.231 23.7963 86.0434 23.7349 85.8538 23.7492 84.3069 23.5917 82.2023 23.4263 79.6928 23.3507 78.9572 23.316 76.7643 23.3018 76.5028 23.3018 70.7688 23.3018 66.8841 24.6566 66.8841 29.896V30.6175C66.7176 32.1302 67.1073 33.6518 67.9804 34.8983 68.8535 36.1447 70.1503 37.0309 71.6289 37.3913 71.6289 37.3913 78.0167 39.6802 78.2231 39.7637 79.2202 40.2583 79.5778 40.8018 79.5778 41.4965V41.9502C79.5778 43.0781 78.6768 43.5728 76.9171 43.5728H67.5268C67.4402 43.5743 67.3548 43.5934 67.2757 43.6287 67.1966 43.6641 67.1255 43.7151 67.0667 43.7787 67.0078 43.8423 66.9624 43.9171 66.9332 43.9986 66.904 44.0802 66.8916 44.1668 66.8967 44.2533V47.9111C66.8967 48.1317 67.0337 48.5413 67.667 48.5854 69.2139 48.7429 71.3185 48.9083 73.828 48.9839 74.5636 49.0186 76.7565 49.0328 77.018 49.0328 82.752 49.0328 86.6367 47.678 86.6367 42.4386V41.7171C86.8032 40.2044 86.4135 38.6828 85.5404 37.4363 84.6673 36.1898 83.3705 35.3037 81.8919 34.9433 81.8919 34.9433 75.5041 32.6544 75.2977 32.5709 74.3006 32.0762 73.943 31.5328 73.943 30.8381V30.3749C73.943 29.247 74.8441 28.746 76.6037 28.746M98.7933 28.7618H108.185C108.271 28.7594 108.355 28.7399 108.434 28.7047 108.512 28.6694 108.582 28.6189 108.641 28.5562 108.7 28.4935 108.745 28.4198 108.775 28.3394 108.805 28.2589 108.819 28.1733 108.815 28.0876V24.4093C108.8 24.2197 108.711 24.0437 108.567 23.92 108.422 23.7963 108.235 23.7349 108.045 23.7492 106.498 23.5917 104.394 23.4263 101.884 23.3507 101.148 23.316 98.9556 23.3018 98.6941 23.3018 92.96 23.3018 89.0753 24.6566 89.0753 29.896V30.6175C88.9088 32.1302 89.2985 33.6518 90.1716 34.8983 91.0447 36.1447 92.3416 37.0309 93.8201 37.3913 93.8201 37.3913 100.208 39.6802 100.414 39.7637 101.411 40.2583 101.769 40.8018 101.769 41.4965V41.9502C101.769 43.0781 100.868 43.5728 99.1084 43.5728H89.7164C89.6298 43.5743 89.5444 43.5934 89.4653 43.6287 89.3863 43.6641 89.3152 43.7151 89.2563 43.7787 89.1974 43.8423 89.1521 43.9171 89.1229 43.9986 89.0936 44.0802 89.0812 44.1668 89.0863 44.2533V47.9111C89.0863 48.1317 89.2234 48.5413 89.8566 48.5854 91.4036 48.7429 93.5082 48.9083 96.0176 48.9839 96.7533 49.0186 98.9461 49.0328 99.2076 49.0328 104.942 49.0328 108.826 47.678 108.826 42.4386V41.7171C108.993 40.2044 108.603 38.6828 107.73 37.4363 106.857 36.1898 105.56 35.3037 104.082 34.9433 104.082 34.9433 97.6938 32.6544 97.4874 32.5709 96.4902 32.0762 96.1326 31.5328 96.1326 30.8381V30.3749C96.1326 29.247 97.0337 28.746 98.7933 28.746M134.345 23.316C132.106 23.1876 129.868 23.5785 127.806 24.4581 125.75 23.5559 123.506 23.164 121.267 23.316 113.181 23.316 111.386 25.7987 111.386 34.132V48.4137C111.386 48.5808 111.453 48.7411 111.571 48.8592 111.689 48.9774 111.849 49.0438 112.016 49.0438H117.428C117.594 49.0413 117.753 48.9742 117.87 48.8565 117.988 48.7389 118.055 48.58 118.058 48.4137V35.8444C118.058 30.3781 118.573 29.3195 121.262 29.1194 123.765 29.3053 124.384 30.2394 124.46 34.7905V48.4042C124.466 48.5709 124.536 48.7289 124.655 48.846 124.773 48.9631 124.932 49.0304 125.099 49.0343H130.51C130.678 49.0343 130.838 48.9679 130.956 48.8498 131.074 48.7316 131.141 48.5713 131.141 48.4042V34.7921C131.216 30.2331 131.835 29.299 134.338 29.1131 137.027 29.3132 137.543 30.3733 137.543 35.8381V48.4074C137.543 48.5745 137.609 48.7348 137.727 48.8529 137.845 48.9711 138.006 49.0375 138.173 49.0375H143.584C143.75 49.0354 143.909 48.9684 144.027 48.8507 144.145 48.7329 144.212 48.5738 144.214 48.4074V34.1257C144.214 25.7924 142.461 23.3097 134.334 23.3097"></path></svg></a></div></div></footer><div id="modal-portal"></div></div><script id="__NEXT_DATA__" type="application/json" nonce="IctLp8qz3R6vjRO3fGq4l9QypNt4B9nSUAeczbXHjL0=">{"props":{"pageProps":{"article":{"id":420146,"postType":"Article","slug":"zmk-auto-mouse-layer","commentsCount":1,"likedCount":32,"bookmarkedCount":21,"bodyLettersCount":12715,"articleType":"tech","emoji":"⌨️","isSuspendingPrivate":false,"publishedAt":"2025-06-15T17:17:09.327+09:00","bodyUpdatedAt":"2025-09-28T18:42:56.594+09:00","sourceRepoUpdatedAt":"2025-09-28T18:42:56.589+09:00","pinned":false,"path":"/kot149/articles/zmk-auto-mouse-layer","principalType":"User","title":"ZMKのオートマウスレイヤーを極める","tocEnabled":true,"shouldNoindex":false,"scheduledPublishAt":null,"canSendBadge":false,"status":"published","ogImageUrl":"https://res.cloudinary.com/zenn/image/upload/s--wsvO4p9M--/c_fit%2Cg_north_west%2Cl_text:notosansjp-medium.otf_55:ZMK%25E3%2581%25AE%25E3%2582%25AA%25E3%2583%25BC%25E3%2583%2588%25E3%2583%259E%25E3%2582%25A6%25E3%2582%25B9%25E3%2583%25AC%25E3%2582%25A4%25E3%2583%25A4%25E3%2583%25BC%25E3%2582%2592%25E6%25A5%25B5%25E3%2582%2581%25E3%2582%258B%2Cw_1010%2Cx_90%2Cy_100/g_south_west%2Cl_text:notosansjp-medium.otf_37:kot149%2Cx_203%2Cy_121/g_south_west%2Ch_90%2Cl_fetch:aHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3plbm4tdXNlci11cGxvYWQvYXZhdGFyL2JlMjhmNWUwZjkuanBlZw==%2Cr_max%2Cw_90%2Cx_87%2Cy_95/v1627283836/default/og-base-w1200-v2.png?_a=BACAGSGT","bodyHtml":"\u003ch2 id=\"%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%A8%E3%81%AF\" data-line=\"0\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%A8%E3%81%AF\" aria-hidden=\"true\"\u003e\u003c/a\u003e オートマウスレイヤーとは\u003c/h2\u003e\n\u003cp data-line=\"2\" class=\"code-line\"\u003eオートマウスレイヤーとは、\u003cstrong\u003e「マウスカーソルを動かすと、自動的に一定時間マウスレイヤーが有効になる機能」\u003c/strong\u003e のことです。\u003cbr\u003e\n自動マウスレイヤー、または略してAMLと呼ばれる場合もあります。\u003c/p\u003e\n\u003cp data-line=\"5\" class=\"code-line\"\u003eAMLを利用することで、\u003ca href=\"https://shirogane-lab.net/items/64b8f8693ee3fd0045280190\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eKeyballシリーズ\u003c/a\u003eのようなトラックボール付きキーボードにおいて、デフォルトレイヤーのキー数を節約しつつ、キー入力とマウス操作をスムーズに切り替えることが可能になります。\u003c/p\u003e\n\u003cp data-line=\"7\" class=\"code-line\"\u003eこの記事では、Keyball/QMKのAMLにあるような\u003c/p\u003e\n\u003cul data-line=\"9\" class=\"code-line\"\u003e\n\u003cli data-line=\"9\" class=\"code-line\"\u003e非マウスキーを押したらマウスレイヤーを抜ける\u003c/li\u003e\n\u003cli data-line=\"10\" class=\"code-line\"\u003eマウスキーを押したらタイムアウトを延長する\u003c/li\u003e\n\u003cli data-line=\"11\" class=\"code-line\"\u003eマウスキーを押すまでマウスレイヤーに留まる\u003csup class=\"footnote-ref\"\u003e\u003ca href=\"#fn-85a1-1\" id=\"fnref-85a1-1\"\u003e[1]\u003c/a\u003e\u003c/sup\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"15\" class=\"code-line\"\u003eなどの機能をZMKで設定する方法を解説します。\u003c/p\u003e\n\u003caside class=\"msg message\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"18\" class=\"code-line\"\u003eこの記事では、トラックボール付きキーボードである\u003ca href=\"https://github.com/kumamuk-git/roBa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eroBa\u003c/a\u003eを例として設定例を示しますが、他のZMKを採用したキーボードにも共通して使用可能です。\u003cbr\u003e\nただし、設定の記載先のファイルや、ピン、ラベルの名前は異なる可能性があります。\u003c/p\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003ch2 id=\"zmk%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC\" data-line=\"22\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#zmk%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC\" aria-hidden=\"true\"\u003e\u003c/a\u003e ZMKにおけるオートマウスレイヤー\u003c/h2\u003e\n\u003cp data-line=\"24\" class=\"code-line\"\u003eZMKのオートマウスレイヤーには\u003c/p\u003e\n\u003col data-line=\"26\" class=\"code-line\"\u003e\n\u003cli data-line=\"26\" class=\"code-line\"\u003e\n\u003ca href=\"https://github.com/inorichi/zmk-pmw3610-driver\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ezmk-pmw3610-driver\u003c/a\u003e\u003csup class=\"footnote-ref\"\u003e\u003ca href=\"#fn-85a1-2\" id=\"fnref-85a1-2\"\u003e[2]\u003c/a\u003e\u003c/sup\u003e で実装されているもの\u003c/li\u003e\n\u003cli data-line=\"27\" class=\"code-line\"\u003e\n\u003ca href=\"https://zmk.dev/docs/keymaps/input-processors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eInput Processor\u003c/a\u003e を使用したもの\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp data-line=\"29\" class=\"code-line\"\u003eの2種類が存在します。\u003c/p\u003e\n\u003cp data-line=\"33\" class=\"code-line\"\u003ezmk-pmw3610-driverのAML機能は非常にシンプルで、QMKにあるような、\u003c/p\u003e\n\u003cul data-line=\"35\" class=\"code-line\"\u003e\n\u003cli data-line=\"35\" class=\"code-line\"\u003e非マウスキーを押したらマウスレイヤーを抜ける\u003c/li\u003e\n\u003cli data-line=\"36\" class=\"code-line\"\u003eマウスキーを押したらタイムアウトを延長する\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"38\" class=\"code-line\"\u003eという機能はありません。\u003c/p\u003e\n\u003cp data-line=\"40\" class=\"code-line\"\u003eInput ProcessorによるAMLは、pmw3610-driverのAMLより新しくできたもので、より汎用的かつ高機能であり、設定すれば上記の機能も使用可能になります。\u003cbr\u003e\n今から新しく設定するなら、Input Processorを使用することを推奨します。\u003c/p\u003e\n\u003ch2 id=\"%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95\" data-line=\"43\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定方法\u003c/h2\u003e\n\u003ch3 id=\"pmw3610-driver%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC\" data-line=\"46\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#pmw3610-driver%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC\" aria-hidden=\"true\"\u003e\u003c/a\u003e PMW3610 Driverのオートマウスレイヤー\u003c/h3\u003e\n\u003cp data-line=\"48\" class=\"code-line\"\u003e\u003ccode\u003e\u0026amp;trackball\u003c/code\u003eに\u003ccode\u003eautomouse-layer\u003c/code\u003eを設定します。\u003cbr\u003e\nこの例では、トラボを動かすとレイヤー5が有効になります。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"diff-highlight language-diff-dts\"\u003e\u003ccode class=\"diff-highlight language-diff-dts code-line\" data-line=\"51\"\u003e\u0026amp;spi0 {\n\u003cspan class=\"token unchanged\"\u003e\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   status = \"okay\";\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   compatible = ...\n\u003c/span\u003e\n\u003cspan class=\"token unchanged\"\u003e\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   trackball: trackball@0 {\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e       status = \"okay\";\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e       compatible = \"pixart,pmw3610\";\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e       ...\n\u003c/span\u003e\n\u003cspan class=\"token inserted-sign inserted\"\u003e\u003cspan class=\"token prefix inserted\"\u003e+\u003c/span\u003e       automouse-layer = \u0026lt;5\u0026gt;;\n\u003c/span\u003e\u003cspan class=\"token unchanged\"\u003e\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   };\n\u003c/span\u003e};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003cp data-line=\"66\" class=\"code-line\"\u003eタイムアウトの長さを変えるには、\u003ccode\u003eCONFIG_PMW3610_AUTOMOUSE_TIMEOUT_MS\u003c/code\u003eを設定します。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.conf\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-kconfig\"\u003e\u003ccode class=\"language-kconfig code-line\" data-line=\"68\"\u003eCONFIG_PMW3610_AUTOMOUSE_TIMEOUT_MS=700\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003ch3 id=\"input-processor%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC\" data-line=\"72\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#input-processor%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC\" aria-hidden=\"true\"\u003e\u003c/a\u003e Input Processorを使用したオートマウスレイヤー\u003c/h3\u003e\n\u003cp data-line=\"74\" class=\"code-line\"\u003e\u003ccode\u003e\u0026amp;trackball_listener\u003c/code\u003eに\u003ca href=\"https://zmk.dev/docs/keymaps/input-processors/temp-layer#user-defined-instances\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003ccode\u003ezip_temp_layer\u003c/code\u003e\u003c/a\u003eというInput Processorを適用します。\u003c/p\u003e\n\u003caside class=\"msg message\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"78\" class=\"code-line\"\u003eトラックボール以外の場合は、\u003ccode\u003etrackball_listener\u003c/code\u003eとは違う名前がつけられている可能性があります。その場合は、\u003ccode\u003e*_listener\u003c/code\u003eという名前や、\u003ccode\u003ecompatible = \"zmk,input-listener\";\u003c/code\u003eが指定されているものを代わりに用いてください。\u003c/p\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003cp data-line=\"81\" class=\"code-line\"\u003eこの例では、トラボ使用後10秒間、レイヤー5が有効になります。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"83\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n/ {\n    trackball_listener: trackball_listener {\n        compatible = \"zmk,input-listener\";\n        device = \u0026lt;\u0026amp;trackball\u0026gt;;\n\n        input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 10000\u0026gt;;\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003caside class=\"msg message\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"96\" class=\"code-line\"\u003e\u003ccode\u003etrackball_listener\u003c/code\u003eは、\u003ccode\u003e.overlay\u003c/code\u003eファイルか\u003ccode\u003e.dtsi\u003c/code\u003eファイルに記載されていることが多いですが、以下のような形で\u003ccode\u003e.keymap\u003c/code\u003eファイルに書かれている場合もあります。\u003ccode\u003e.keyamp\u003c/code\u003eに書かれている場合はそちらへ追加してください。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"98\"\u003e/ {\n    trackball_listener: trackball_listener {\n        compatible = \"zmk,input-listener\";\n        device = \u0026lt;\u0026amp;trackball\u0026gt;;\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa.keymap\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"107\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n\n\u0026amp;trackball_listener {\n    input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 10000\u0026gt;;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003caside class=\"msg alert\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"117\" class=\"code-line\"\u003eInput Processorを使用する場合は、zmk-pmw3610-driverのAMLは無効化しておきましょう。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"diff-highlight language-diff-dts\"\u003e\u003ccode class=\"diff-highlight language-diff-dts code-line\" data-line=\"119\"\u003e\u0026amp;spi0 {\n\u003cspan class=\"token unchanged\"\u003e\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   status = \"okay\";\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   compatible = ...\n\u003c/span\u003e\n\u003cspan class=\"token unchanged\"\u003e\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   trackball: trackball@0 {\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e       status = \"okay\";\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e       compatible = \"pixart,pmw3610\";\n\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e       ...\n\u003c/span\u003e\n\u003cspan class=\"token deleted-sign deleted\"\u003e\u003cspan class=\"token prefix deleted\"\u003e-\u003c/span\u003e       automouse-layer = \u0026lt;5\u0026gt;;\n\u003c/span\u003e\u003cspan class=\"token unchanged\"\u003e\u003cspan class=\"token prefix unchanged\"\u003e \u003c/span\u003e   };\n\u003c/span\u003e};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003ch3 id=\"%E9%9D%9E%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E9%96%A2%E4%BF%82%E3%81%AA%E3%81%8F%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%8A%9C%E3%81%91%E3%82%8B\" data-line=\"135\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E9%9D%9E%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E9%96%A2%E4%BF%82%E3%81%AA%E3%81%8F%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%8A%9C%E3%81%91%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 非マウスキーを押したらタイムアウトに関係なくマウスレイヤーを抜ける\u003c/h3\u003e\n\u003cp data-line=\"137\" class=\"code-line\"\u003eInput Processorを使用したAMLでは、\u003ccode\u003eexcluded-positions\u003c/code\u003eを設定すると、その位置のキー以外を押したときにAMLが解除されます。\u003c/p\u003e\n\u003caside class=\"msg message\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"140\" class=\"code-line\"\u003e\u003cstrong\u003e注意点\u003c/strong\u003e:\u003c/p\u003e\n\u003cul data-line=\"141\" class=\"code-line\"\u003e\n\u003cli data-line=\"141\" class=\"code-line\"\u003eQMKのようにマウスキーがあらかじめ定義されていないため、手動で\u003ccode\u003eexcluded-positions\u003c/code\u003eに加える必要がある\u003c/li\u003e\n\u003cli data-line=\"142\" class=\"code-line\"\u003e\n\u003ccode\u003eexcluded-positions\u003c/code\u003eを設定しなかった場合、「どのキーを押してもAMLが\u003cstrong\u003e解除されない\u003c/strong\u003e」。この仕様は少し分かりづらい…\u003c/li\u003e\n\u003cli data-line=\"143\" class=\"code-line\"\u003e\n\u003ccode\u003eexcluded-positions\u003c/code\u003eのキーを押してもタイムアウトの延長はされないため、別途設定が必要\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003ch4 id=\"%E8%A8%AD%E5%AE%9A%E4%BE%8B\" data-line=\"146\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E4%BE%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定例\u003c/h4\u003e\n\u003cp data-line=\"148\" class=\"code-line\"\u003eこの例では、トラボ使用後10秒間、レイヤー5が有効になります。\u003cbr\u003e\nただし、\u003ccode\u003eexcluded-positions\u003c/code\u003e以外のキーを押すとAMLが解除されます。ここではroBaの\u003ccode\u003eJ\u003c/code\u003e, \u003ccode\u003eK\u003c/code\u003e, \u003ccode\u003e;\u003c/code\u003e, \u003ccode\u003eCtrl\u003c/code\u003eの位置を\u003ccode\u003eexcluded-positions\u003c/code\u003eに設定しています。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"151\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n\n\u0026amp;zip_temp_layer {\n    excluded-positions = \u0026lt;\n        18 // J\n        19 // K\n        21 // ;\n        34 // Ctrl\n    \u0026gt;;\n};\n\n/ {\n    trackball_listener: trackball_listener {\n        compatible = \"zmk,input-listener\";\n        device = \u0026lt;\u0026amp;trackball\u0026gt;;\n\n        input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 10000\u0026gt;;\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003caside class=\"msg message\"\u003e\u003cspan class=\"msg-symbol\"\u003e!\u003c/span\u003e\u003cdiv class=\"msg-content\"\u003e\n\u003cp data-line=\"174\" class=\"code-line\"\u003e\u003ccode\u003eexcluded-positions\u003c/code\u003eの数字はキーボードのレイアウト次第で変わります。\u003cbr\u003e\npositionを知るには、\u003ca href=\"https://nickcoutsos.github.io/keymap-editor/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eKeymap Editor\u003c/a\u003eで適当なcomboを作って、keymapファイルのcombo定義から\u003ccode\u003ekey-positions\u003c/code\u003eを抜き出すか、\u003ca href=\"https://zmk-physical-layout-converter.streamlit.app\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eZMK physical layouts converter\u003c/a\u003eにレイアウト定義JSONファイルを貼り付けて確認するのが簡単です。\u003c/p\u003e\n\u003c/div\u003e\u003c/aside\u003e\n\u003ch3 id=\"%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B\" data-line=\"178\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e マウスキーを押したらタイムアウトを延長する\u003c/h3\u003e\n\u003cp data-line=\"180\" class=\"code-line\"\u003e\u003ccode\u003e\u0026amp;mkp\u003c/code\u003e(マウスキー押下)に対してInput Processorを設定することで、マウスキーを押したらタイムアウトを延長できます。\u003c/p\u003e\n\u003ch4 id=\"%E8%A8%AD%E5%AE%9A%E4%BE%8B-1\" data-line=\"182\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E4%BE%8B-1\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定例\u003c/h4\u003e\n\u003cp data-line=\"184\" class=\"code-line\"\u003e\u003ccode\u003e.keymap\u003c/code\u003eファイルに以下を追記すると、クリックしたときに10秒間AMLが延長されます。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa.keymap\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"186\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n\n\u0026amp;mkp_input_listener {\n    input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 10000\u0026gt;;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003ch3 id=\"%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%99%E3%81%BE%E3%81%A7%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AB%E7%95%99%E3%81%BE%E3%82%8B\" data-line=\"194\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%99%E3%81%BE%E3%81%A7%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AB%E7%95%99%E3%81%BE%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e マウスキーを押すまでマウスレイヤーに留まる\u003c/h3\u003e\n\u003cp data-line=\"196\" class=\"code-line\"\u003eマウスキーを押すまでマウスレイヤーに留まる場合でも、ダブルクリックの猶予を与えるために、クリック後一定時間待つ必要があります。\u003cbr\u003e\nそのため、実は「マウスキーを押すまでマウスレイヤーに留まる」機能は「\u003ca href=\"#%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B\"\u003eマウスキーを押したらタイムアウトを延長する\u003c/a\u003e」と同じ実装で、タイムアウトの長さが違うだけです。\u003c/p\u003e\n\u003ch4 id=\"%E8%A8%AD%E5%AE%9A%E4%BE%8B-2\" data-line=\"199\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E4%BE%8B-2\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定例\u003c/h4\u003e\n\u003cp data-line=\"201\" class=\"code-line\"\u003e\u003ccode\u003e.keymap\u003c/code\u003eファイルに以下を追記すると、クリックした後250ミリ秒後にAMLが解除されます。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa.keymap\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"203\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n\n\u0026amp;mkp_input_listener {\n    input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 250\u0026gt;;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003cp data-line=\"211\" class=\"code-line\"\u003eまた、AML自体のタイムアウトは長めにしておきましょう。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.conf\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-kconfig\"\u003e\u003ccode class=\"language-kconfig code-line\" data-line=\"213\"\u003eCONFIG_PMW3610_AUTOMOUSE_TIMEOUT_MS=100000\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003cp data-line=\"217\" class=\"code-line\"\u003eまたは、Input Processorを使用している場合:\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"219\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n/ {\n    trackball_listener: trackball_listener {\n        compatible = \"zmk,input-listener\";\n        device = \u0026lt;\u0026amp;trackball\u0026gt;;\n\n        input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 100000\u0026gt;;\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003ch3 id=\"%E3%82%AD%E3%83%BC%E5%85%A5%E5%8A%9B%E4%B8%AD%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%AA%A4%E7%88%86%E9%98%B2%E6%AD%A2\" data-line=\"231\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%AD%E3%83%BC%E5%85%A5%E5%8A%9B%E4%B8%AD%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%AA%A4%E7%88%86%E9%98%B2%E6%AD%A2\" aria-hidden=\"true\"\u003e\u003c/a\u003e キー入力中のオートマウスレイヤー誤爆防止\u003c/h3\u003e\n\u003cp data-line=\"233\" class=\"code-line\"\u003eキー入力中、振動や意図せずトラボに触れてしまうことが原因でAMLが発動し、マウスクリックが誤爆することがあります。\u003cbr\u003e\nこれの対策として、Input Processorを使用したAMLでは、\u003ccode\u003erequire-prior-idle-ms\u003c/code\u003eというプロパティを設定することで、キー入力から一定時間はAMLを発動しないようにできます。\u003c/p\u003e\n\u003ch4 id=\"%E8%A8%AD%E5%AE%9A%E4%BE%8B-3\" data-line=\"236\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E4%BE%8B-3\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定例\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa_R.overlay\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"238\"\u003e#include \u0026lt;input/processors.dtsi\u0026gt;\n\n\u0026amp;zip_temp_layer {\n    require-prior-idle-ms = \u0026lt;200\u0026gt;;\n};\n\n/ {\n    trackball_listener: trackball_listener {\n        compatible = \"zmk,input-listener\";\n        device = \u0026lt;\u0026amp;trackball\u0026gt;;\n\n        input-processors = \u0026lt;\u0026amp;zip_temp_layer 5 10000\u0026gt;;\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003ch3 id=\"shift%2B%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%8B%95%E4%BD%9C%E6%94%B9%E5%96%84\" data-line=\"255\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#shift%2B%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%8B%95%E4%BD%9C%E6%94%B9%E5%96%84\" aria-hidden=\"true\"\u003e\u003c/a\u003e Shift+クリックの動作改善\u003c/h3\u003e\n\u003cp data-line=\"257\" class=\"code-line\"\u003eShiftキーをZキーのMod Tap(\u003ccode\u003e\u0026amp;mt LEFT_SHIFT Z\u003c/code\u003e)にしているような場合、上記のInput Processorを使用したAMLでは、\u003cbr\u003e\n「マウスカーソルを動かす → Shiftを押す → クリックする」\u003cbr\u003e\nという操作によりテキストを選択しようとすると、Shiftを押した段階でAMLが解除され、クリックのつもりがキー入力になってしまいます。\u003c/p\u003e\n\u003cp data-line=\"261\" class=\"code-line\"\u003e必ずShiftを押した後にマウスカーソルを動かすようにすれば対処できますが、少し面倒です。\u003cbr\u003e\n\u003ccode\u003eexcluded-positions\u003c/code\u003eに設定する手もありますが、それだとZを入力したときにAMLが解除されず、誤爆の原因になります。\u003c/p\u003e\n\u003cp data-line=\"264\" class=\"code-line\"\u003eこれは、タップ時のみAML解除するbehaviorを定義することで解決できます。\u003c/p\u003e\n\u003ch4 id=\"%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-1\" data-line=\"266\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-1\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定方法\u003c/h4\u003e\n\u003col data-line=\"268\" class=\"code-line\"\u003e\n\u003cli data-line=\"268\" class=\"code-line\"\u003eレイヤーを無効化するbehavior \u003ccode\u003etog_off\u003c/code\u003e\u003csup class=\"footnote-ref\"\u003e\u003ca href=\"#fn-85a1-3\" id=\"fnref-85a1-3\"\u003e[3]\u003c/a\u003e\u003c/sup\u003eを定義する\u003c/li\u003e\n\u003cli data-line=\"269\" class=\"code-line\"\u003eAMLを解除するマクロ\u003ccode\u003eexit_AML\u003c/code\u003eを作る\u003c/li\u003e\n\u003cli data-line=\"270\" class=\"code-line\"\u003eキー押下後にAMLを解除するマクロ\u003ccode\u003ekp_exit_AML\u003c/code\u003eを作る\u003c/li\u003e\n\u003cli data-line=\"271\" class=\"code-line\"\u003eホールド時は\u003ccode\u003ekp\u003c/code\u003e、タップ時は\u003ccode\u003ekp_exit_AML\u003c/code\u003eを使うhold-tap behavior \u003ccode\u003emt_exit_AML_on_tap\u003c/code\u003eを定義する\u003c/li\u003e\n\u003cli data-line=\"272\" class=\"code-line\"\u003e\n\u003ccode\u003emt_exit_AML_on_tap\u003c/code\u003eを\u003ccode\u003emt\u003c/code\u003eの代わりに使う\u003c/li\u003e\n\u003cli data-line=\"273\" class=\"code-line\"\u003eそのキーの位置を\u003ccode\u003eexcluded-positions\u003c/code\u003eに入れる\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp data-line=\"275\" class=\"code-line\"\u003eこれによりホールド時はAMLを解除せず、タップ時のみAMLを解除するという動作が可能になります。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa.keymap\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"279\"\u003e#define MOUSE 5\n\n/{\n    macros {\n        exit_AML: exit_AML {\n            compatible = \"zmk,behavior-macro\";\n            wait-ms = \u0026lt;0\u0026gt;;\n            tap-ms = \u0026lt;0\u0026gt;;\n            #binding-cells = \u0026lt;0\u0026gt;;\n            bindings = \u0026lt;\u0026amp;tog_off MOUSE\u0026gt;;\n            label = \"exit_AML\";\n        };\n\n        kp_exit_AML: kp_exit_AML {\n            compatible = \"zmk,behavior-macro-one-param\";\n            wait-ms = \u0026lt;0\u0026gt;;\n            tap-ms = \u0026lt;0\u0026gt;;\n            #binding-cells = \u0026lt;1\u0026gt;;\n            bindings = \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;kp MACRO_PLACEHOLDER \u0026amp;exit_AML\u0026gt;;\n            label = \"KP_exit_AML\";\n        };\n    };\n\n    behaviors {\n        tog_off: toggle_layer_off {\n            compatible = \"zmk,behavior-toggle-layer\";\n            #binding-cells = \u0026lt;1\u0026gt;;\n            display-name = \"Toggle Layer Off\";\n            toggle-mode = \"off\";\n        };\n\n        mt_exit_AML_on_tap: mt_exit_AML_on_tap {\n            compatible = \"zmk,behavior-hold-tap\";\n            label = \"MT_exit_AML_ON_TAP\";\n            bindings = \u0026lt;\u0026amp;kp\u0026gt;, \u0026lt;\u0026amp;kp_exit_AML\u0026gt;;\n\n            #binding-cells = \u0026lt;2\u0026gt;;\n            tapping-term-ms = \u0026lt;200\u0026gt;;\n            flavor = \"balanced\";\n            quick-tap-ms = \u0026lt;200\u0026gt;;\n        };\n    };\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003ch3 id=\"%E3%82%AA%E3%83%9E%E3%82%B1%3A-%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%A7%E5%86%8D%E7%8F%BE%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\" data-line=\"325\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E3%82%AA%E3%83%9E%E3%82%B1%3A-%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%A7%E5%86%8D%E7%8F%BE%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\" aria-hidden=\"true\"\u003e\u003c/a\u003e オマケ: マクロで再現する方法\u003c/h3\u003e\n\u003cp data-line=\"327\" class=\"code-line\"\u003eキー入力中のAML誤爆防止以外は、Input Processorを使わなくても、pmw3610-driverのAML+マクロで再現できます。\u003c/p\u003e\n\u003cp data-line=\"329\" class=\"code-line\"\u003e今あえてInput Processorを使わずにpmw3610-driverのAML+マクロで頑張る理由は特にありませんが、過去にInput Processorの不具合でフリーズすることがあった(現在は修正済み)ため、そういった場合の代替手段として使用できました。\u003c/p\u003e\n\u003cp data-line=\"331\" class=\"code-line\"\u003eZMKは一見融通が利かないように見えて、実は大抵のことはマクロ+レイヤー移動で解決できてしまいます。ZMKのそういうところの面白さや魅力を感じていただければ幸いです。\u003c/p\u003e\n\u003ch4 id=\"%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-2\" data-line=\"333\" class=\"code-line\"\u003e\n\u003ca class=\"header-anchor-link\" href=\"#%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95-2\" aria-hidden=\"true\"\u003e\u003c/a\u003e 設定方法\u003c/h4\u003e\n\u003cp data-line=\"334\" class=\"code-line\"\u003e\u003ccode\u003eexit_AML\u003c/code\u003eを仕込んだ\u003ccode\u003ekp\u003c/code\u003e、\u003ccode\u003emt\u003c/code\u003e、\u003ccode\u003emo\u003c/code\u003e、\u003ccode\u003elt\u003c/code\u003eを作り、代わりに使います。\u003cbr\u003e\nタイムアウトに関連する動作はSticky Layer(\u003ccode\u003esl\u003c/code\u003e)を組み合わせることで作れます。\u003c/p\u003e\n\u003cp data-line=\"337\" class=\"code-line\"\u003eこの\u003ccode\u003emt\u003c/code\u003e/\u003ccode\u003elt\u003c/code\u003eではキータップ+長押しで連打が効かなくなりますが、hold時のみAML解除するものを使うと回避できます。\u003c/p\u003e\n\u003cp data-line=\"339\" class=\"code-line\"\u003e「マウスキーを押したらタイムアウトを延長する」「マウスキーを押すまでマウスレイヤーに留まる」には、\u003ccode\u003emkp_exit_AML\u003c/code\u003eを使います。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\n\u003cdiv class=\"code-block-filename-container\"\u003e\u003cspan class=\"code-block-filename\"\u003eroBa.keymap\u003c/span\u003e\u003c/div\u003e\n\u003cpre class=\"language-dts\"\u003e\u003ccode class=\"language-dts code-line\" data-line=\"341\"\u003e#define MOUSE 5\n\n/{\n    macros {\n        exit_AML: exit_AML {\n            compatible = \"zmk,behavior-macro\";\n            wait-ms = \u0026lt;0\u0026gt;;\n            tap-ms = \u0026lt;0\u0026gt;;\n            #binding-cells = \u0026lt;0\u0026gt;;\n            bindings = \u0026lt;\u0026amp;tog_off MOUSE\u0026gt;;\n            label = \"exit_AML\";\n        };\n\n        kp_exit_AML: kp_exit_AML {\n            compatible = \"zmk,behavior-macro-one-param\";\n            wait-ms = \u0026lt;0\u0026gt;;\n            tap-ms = \u0026lt;0\u0026gt;;\n            #binding-cells = \u0026lt;1\u0026gt;;\n            bindings = \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;kp MACRO_PLACEHOLDER \u0026amp;exit_AML\u0026gt;;\n            label = \"KP_exit_AML\";\n        };\n\n        mod_exit_AML: mod_exit_AML {\n            compatible = \"zmk,behavior-macro-one-param\";\n            wait-ms = \u0026lt;0\u0026gt;;\n            tap-ms = \u0026lt;0\u0026gt;;\n            #binding-cells = \u0026lt;1\u0026gt;;\n            bindings =\n                \u0026lt;\u0026amp;macro_press\u0026gt;,\n                \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;kp MACRO_PLACEHOLDER\u0026gt;,\n                \u0026lt;\u0026amp;macro_tap\u0026gt;,\n                \u0026lt;\u0026amp;exit_AML\u0026gt;,\n                \u0026lt;\u0026amp;macro_pause_for_release\u0026gt;,\n                \u0026lt;\u0026amp;macro_release\u0026gt;,\n                \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;kp MACRO_PLACEHOLDER\u0026gt;;\n\n            label = \"MOD_exit_AML\";\n        };\n\n        mo_exit_AML: mo_exit_AML {\n            compatible = \"zmk,behavior-macro-one-param\";\n            wait-ms = \u0026lt;0\u0026gt;;\n            tap-ms = \u0026lt;0\u0026gt;;\n            #binding-cells = \u0026lt;1\u0026gt;;\n            bindings =\n                \u0026lt;\u0026amp;macro_press\u0026gt;,\n                \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;mo MACRO_PLACEHOLDER\u0026gt;,\n                \u0026lt;\u0026amp;macro_tap\u0026gt;,\n                \u0026lt;\u0026amp;exit_AML\u0026gt;,\n                \u0026lt;\u0026amp;macro_pause_for_release\u0026gt;,\n                \u0026lt;\u0026amp;macro_release\u0026gt;,\n                \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;mo MACRO_PLACEHOLDER\u0026gt;,\n                \u0026lt;\u0026amp;macro_tap\u0026gt;;\n\n            label = \"MO_exit_AML\";\n        };\n\n        mkp_exit_AML: mkp_exit_AML {\n            compatible = \"zmk,behavior-macro-one-param\";\n            #binding-cells = \u0026lt;1\u0026gt;;\n            bindings =\n                \u0026lt;\u0026amp;macro_press\u0026gt;,\n                \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;mkp MACRO_PLACEHOLDER\u0026gt;,\n                \u0026lt;\u0026amp;macro_pause_for_release\u0026gt;,\n                \u0026lt;\u0026amp;macro_release\u0026gt;,\n                \u0026lt;\u0026amp;macro_param_1to1 \u0026amp;mkp MACRO_PLACEHOLDER\u0026gt;,\n                \u0026lt;\u0026amp;macro_tap\u0026gt;,\n                \u0026lt;\u0026amp;sl_250 MOUSE\u0026gt;;\n\n            label = \"MKP_EXIT_AML\";\n        };\n    };\n\n    behaviors {\n        sl_250: sl_250 {\n            compatible = \"zmk,behavior-sticky-key\";\n            label = \"SL_250\";\n            bindings = \u0026lt;\u0026amp;mo\u0026gt;;\n            #binding-cells = \u0026lt;1\u0026gt;;\n            release-after-ms = \u0026lt;250\u0026gt;;\n        };\n\n        tog_off: toggle_layer_off {\n            compatible = \"zmk,behavior-toggle-layer\";\n            #binding-cells = \u0026lt;1\u0026gt;;\n            display-name = \"Toggle Layer Off\";\n            toggle-mode = \"off\";\n        };\n\n        lt_exit_AML: lt_exit_AML {\n            compatible = \"zmk,behavior-hold-tap\";\n            label = \"LT_exit_AML\";\n            bindings = \u0026lt;\u0026amp;mo_exit_AML\u0026gt;, \u0026lt;\u0026amp;kp_exit_AML\u0026gt;;\n\n            #binding-cells = \u0026lt;2\u0026gt;;\n            tapping-term-ms = \u0026lt;200\u0026gt;;\n            quick-tap-ms = \u0026lt;200\u0026gt;;\n            flavor = \"balanced\";\n        };\n\n        lt_exit_AML_on_hold: lt_exit_AML_on_hold {\n            compatible = \"zmk,behavior-hold-tap\";\n            label = \"LT_exit_AML_ON_HOLD\";\n            bindings = \u0026lt;\u0026amp;mo_exit_AML\u0026gt;, \u0026lt;\u0026amp;kp\u0026gt;;\n\n            #binding-cells = \u0026lt;2\u0026gt;;\n            tapping-term-ms = \u0026lt;200\u0026gt;;\n            quick-tap-ms = \u0026lt;200\u0026gt;;\n            flavor = \"balanced\";\n        };\n\n        mt_exit_AML: mt_exit_AML {\n            compatible = \"zmk,behavior-hold-tap\";\n            label = \"MT_exit_AML\";\n            bindings = \u0026lt;\u0026amp;mod_exit_AML\u0026gt;, \u0026lt;\u0026amp;kp_exit_AML\u0026gt;;\n\n            #binding-cells = \u0026lt;2\u0026gt;;\n            tapping-term-ms = \u0026lt;200\u0026gt;;\n            flavor = \"balanced\";\n            quick-tap-ms = \u0026lt;200\u0026gt;;\n        };\n\n        mt_exit_AML_on_tap: mt_exit_AML_on_tap {\n            compatible = \"zmk,behavior-hold-tap\";\n            label = \"MT_exit_AML_ON_TAP\";\n            bindings = \u0026lt;\u0026amp;kp\u0026gt;, \u0026lt;\u0026amp;kp_exit_AML\u0026gt;;\n\n            #binding-cells = \u0026lt;2\u0026gt;;\n            tapping-term-ms = \u0026lt;200\u0026gt;;\n            flavor = \"balanced\";\n            quick-tap-ms = \u0026lt;200\u0026gt;;\n        };\n    };\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\u003chr data-line=\"478\" class=\"code-line\"\u003e\n\u003cp data-line=\"479\" class=\"code-line\"\u003eこの記事はroBaで書きました。\u003c/p\u003e\n\u003csection class=\"footnotes\"\u003e\n\u003cspan class=\"footnotes-title\"\u003e脚注\u003c/span\u003e\n\u003col class=\"footnotes-list\"\u003e\n\u003cli id=\"fn-85a1-1\" class=\"footnote-item\"\u003e\n\u003cp data-line=\"13\" class=\"code-line\"\u003e\u003ca href=\"https://github.com/negokaz/keyball/pull/2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ehttps://github.com/negokaz/keyball/pull/2\u003c/a\u003e \u003ca href=\"#fnref-85a1-1\" class=\"footnote-backref\"\u003e↩︎\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn-85a1-2\" class=\"footnote-item\"\u003e\n\u003cp data-line=\"31\" class=\"code-line\"\u003e\u003ca href=\"https://github.com/inorichi/zmk-pmw3610-driver\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ezmk-pmw3610-driver\u003c/a\u003eはZMKでPMW3610を使用するためのドライバーです。PMW3610はマウスセンサーで、\u003ca href=\"https://github.com/kumamuk-git/roBa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eroBa\u003c/a\u003eや\u003ca href=\"https://github.com/sayu-hub/zmk-config-moNa2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003emoNa2\u003c/a\u003eといった多くのZMKトラボ付きキーボードで採用されています。zmk-pmw3610-driverにはいくつか派生(fork)があり、\u003ca href=\"https://github.com/badjeff/zmk-pmw3610-driver\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ebadjeff氏のフォーク\u003c/a\u003eなどでは、Input ProcessorでAMLが可能になったので、AML機能が削除されています。 \u003ca href=\"#fnref-85a1-2\" class=\"footnote-backref\"\u003e↩︎\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"fn-85a1-3\" class=\"footnote-item\"\u003e\n\u003cp data-line=\"277\" class=\"code-line\"\u003e\u003ca href=\"https://zmk.dev/docs/keymaps/behaviors/layers#toggle-layer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eZMKの公式ドキュメント\u003c/a\u003eに記載されているものです。\u003ca href=\"https://github.com/zmkfirmware/zmk/pull/2943\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eこれらを標準搭載しようというPR\u003c/a\u003eがあるので、これがマージされれば自分で定義しなくても使えるようになります。 \u003ca href=\"#fnref-85a1-3\" class=\"footnote-backref\"\u003e↩︎\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n","toc":[{"id":"%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%A8%E3%81%AF","text":"オートマウスレイヤーとは","level":2,"children":[]},{"id":"zmk%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC","text":"ZMKにおけるオートマウスレイヤー","level":2,"children":[]},{"id":"%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95","text":"設定方法","level":2,"children":[{"id":"pmw3610-driver%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC","text":"PMW3610 Driverのオートマウスレイヤー","level":3,"children":[]},{"id":"input-processor%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC","text":"Input Processorを使用したオートマウスレイヤー","level":3,"children":[]},{"id":"%E9%9D%9E%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%81%AB%E9%96%A2%E4%BF%82%E3%81%AA%E3%81%8F%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92%E6%8A%9C%E3%81%91%E3%82%8B","text":"非マウスキーを押したらタイムアウトに関係なくマウスレイヤーを抜ける","level":3,"children":[]},{"id":"%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E3%82%89%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%A2%E3%82%A6%E3%83%88%E3%82%92%E5%BB%B6%E9%95%B7%E3%81%99%E3%82%8B","text":"マウスキーを押したらタイムアウトを延長する","level":3,"children":[]},{"id":"%E3%83%9E%E3%82%A6%E3%82%B9%E3%82%AD%E3%83%BC%E3%82%92%E6%8A%BC%E3%81%99%E3%81%BE%E3%81%A7%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%81%AB%E7%95%99%E3%81%BE%E3%82%8B","text":"マウスキーを押すまでマウスレイヤーに留まる","level":3,"children":[]},{"id":"%E3%82%AD%E3%83%BC%E5%85%A5%E5%8A%9B%E4%B8%AD%E3%81%AE%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%82%A6%E3%82%B9%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E8%AA%A4%E7%88%86%E9%98%B2%E6%AD%A2","text":"キー入力中のオートマウスレイヤー誤爆防止","level":3,"children":[]},{"id":"shift%2B%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%AE%E5%8B%95%E4%BD%9C%E6%94%B9%E5%96%84","text":"Shift+クリックの動作改善","level":3,"children":[]},{"id":"%E3%82%AA%E3%83%9E%E3%82%B1%3A-%E3%83%9E%E3%82%AF%E3%83%AD%E3%81%A7%E5%86%8D%E7%8F%BE%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95","text":"オマケ: マクロで再現する方法","level":3,"children":[]}]}],"badges":[],"githubDevUrl":"https://github.dev/kot149/zenn-contents/blob/main/articles/zmk-auto-mouse-layer.md","contest":null},"user":{"id":227153,"username":"kot149","name":"kot149","avatarSmallUrl":"https://res.cloudinary.com/zenn/image/fetch/s--XrN-chKK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_70/https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg?_a=BACAGSGT","avatarUrl":"https://storage.googleapis.com/zenn-user-upload/avatar/be28f5e0f9.jpeg","bio":"","autolinkedBio":"","githubUsername":"kot149","twitterUsername":"kot149_","isSupportOpen":false,"tokusyoContact":null,"tokusyoName":null,"websiteUrl":"","websiteDomain":null,"totalLikedCount":55,"gaTrackingId":null,"hatenaId":null,"isInvoiceIssuer":false,"awards":[]},"topics":[{"id":860,"name":"keyboard","taggingsCount":247,"imageUrl":"https://storage.googleapis.com/zenn-user-upload/topics/466b24af98.png","displayName":"Keyboard"},{"id":39146,"name":"zmk","taggingsCount":24,"imageUrl":"https://zenn.dev/images/topic.png","displayName":"zmk"}],"isMine":false,"isPreview":false,"draftRevealScope":"private","githubUrl":"https://github.com/kot149/zenn-contents/blob/main/articles/zmk-auto-mouse-layer.md","githubCommitsUrl":"https://github.com/kot149/zenn-contents/commits/main?path=articles/zmk-auto-mouse-layer.md","githubRepository":{"id":11462,"name":"zenn-contents","fullName":"kot149/zenn-contents","htmlUrl":"https://github.com/kot149/zenn-contents","branchName":"main","public":true,"showGithubLink":true},"currentUserLiked":false,"currentUserBookmarked":false,"comments":[{"id":619719,"postType":"Comment","slug":"77b7d7b9d2e299","userId":232239,"likedCount":1,"bodyUpdatedAt":null,"createdAt":"2025-06-24T23:43:22.773+09:00","pinned":false,"bodyHtml":"\u003cp data-line=\"0\" class=\"code-line\"\u003eroBaish、Zonkeyを愛用していて、キー入力中のトラックボール誤爆に困っていたので、こちらの記事がめちゃくちゃ参考になりました。\u003cbr\u003e\n本当にありがとうございました！\u003c/p\u003e\n","hiddenReason":null,"currentUserLiked":false,"isMine":false,"user":{"id":232239,"username":"katsujp","name":"katsu.jp","avatarSmallUrl":"https://lh3.googleusercontent.com/a/ACg8ocI84AerD7pL1bUBlVPCLc3-56pCXzr4Cr3imtoeRKH00vjUa-xg=s96-c"},"children":[]}],"commentedUsers":[{"id":232239,"username":"katsujp","name":"katsu.jp","avatarSmallUrl":"https://lh3.googleusercontent.com/a/ACg8ocI84AerD7pL1bUBlVPCLc3-56pCXzr4Cr3imtoeRKH00vjUa-xg=s96-c"}],"positiveCommentsCount":1,"publication":null,"publicationArticleOverride":null}},"page":"/[username]/articles/[slug]","query":{"username":"kot149","slug":"zmk-auto-mouse-layer"},"buildId":"TlGRyyN3vX07v1SqAl6k1","assetPrefix":"https://static.zenn.studio","isFallback":false,"isExperimentalCompile":false,"dynamicIds":[30782],"gip":true,"scriptLoader":[]}</script></body></html>